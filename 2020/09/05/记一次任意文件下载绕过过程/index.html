<!DOCTYPE html><html lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>记一次任意文件下载绕过过程 | 小叹</title><meta name="keywords" content="转载"><meta name="author"><meta name="copyright"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="任意文件下载">
<meta property="og:type" content="article">
<meta property="og:title" content="记一次任意文件下载绕过过程">
<meta property="og:url" content="http://yoursite.com/2020/09/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%BB%95%E8%BF%87%E8%BF%87%E7%A8%8B/index.html">
<meta property="og:site_name" content="小叹">
<meta property="og:description" content="任意文件下载">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg">
<meta property="article:published_time" content="2020-09-05T03:25:01.000Z">
<meta property="article:modified_time" content="2020-09-05T06:22:34.000Z">
<meta property="article:tag" content="悦读">
<meta property="article:tag" content="web">
<meta property="article:tag" content="转载">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/09/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%BB%95%E8%BF%87%E8%BF%87%E7%A8%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="XGwjLQtdgDNnEDwkeuCK-ucz-j3-gHvZkeARGhb9hJU"/><meta name="baidu-site-verification" content="code-n7EnZXbI9l"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '记一次任意文件下载绕过过程',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2020-09-05 14:22:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="小叹" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://tva1.sinaimg.cn/large/008i3skNly1gsxjbgddgvj30u00u0gnx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-comment-dotso"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 关系</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小叹</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-comment-dotso"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 关系</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">记一次任意文件下载绕过过程</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-09-05T03:25:01.000Z" title="Created 2020-09-05 11:25:01">2020-09-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-09-05T06:22:34.000Z" title="Updated 2020-09-05 14:22:34">2020-09-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="记一次任意文件下载绕过过程"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="挖掘过程"><a href="#挖掘过程" class="headerlink" title="挖掘过程"></a>挖掘过程</h1><h2 id="转载：https-www-sec-in-com-article-486"><a href="#转载：https-www-sec-in-com-article-486" class="headerlink" title="转载：https://www.sec-in.com/article/486"></a>转载：<a target="_blank" rel="noopener" href="https://www.sec-in.com/article/486">https://www.sec-in.com/article/486</a></h2><p>  一般来说，在文件下载/查看功能处，当文件名参数可控，且系统未对参数进行过滤或者过滤不全时，就可以实现下载服务器上的任何文件，产生任意文件下载漏洞。<br>  一般可以通过相关的业务关键字（例如download、filename等）或者相关的操作类（例如InputStream、File等）快速定位相关的模块进行审计挖掘。<br>  前段时间审计某项目时发现一处任意文件下载的绕过。<br>  系统基于Springboot进行开发，首先是发现任意文件下载接口:</p>
<pre><code class="java">@Value(&quot;$&#123;CERTIFICATE.PATH&#125;&quot;)
private String uploadPath;

@GetMapping(&quot;/downloadFile.do&quot;)
public void uploadFileDownload(HttpServletResponse response,String fileName) throws IOException &#123;
    ServletOutputStream outputStream =response.getOutputStream();
    String contentType =&quot;application/octet-stream&quot;;
    response.setContentType(contentType);
    String filePath = uploadPath+fileName;
    System.out.println(filePath);
    outputStream.write(FileUtils.readFileToByteArray(filePath));
    outputStream.flush();
    outputStream.close();
&#125;</code></pre>
<p>  相关的接口是下载用户上传的凭证材料的，整个下载过程从配置文件中获取uploadPath，然后与用户输入的fileName进行拼接，最后调用工具类FileUtils的readFileToByteArray()方法进行下载。<br>  查看工具类readFileToByteArray()方法的具体实现：</p>
<pre><code class="java">public static byte[] readFileToByteArray(String path) &#123;
    StringBuffer buf = new StringBuffer();
    try &#123;
        File file = new File(path);
        BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(file), &quot;utf-8&quot;));
        String row;
        while ((row = br.readLine()) != null) &#123;
            buf.append(row);
        &#125;
    &#125; catch (IOException e) &#123;
        e.printStackTrace();
    &#125;
    if (buf.length() == 0) &#123;
        buf.append(&quot;&quot;);
    &#125;
    return buf.toString().getBytes();
&#125;</code></pre>
<p>  可以看到相关的工具类方法直接将传入的地址进行文件内容读取，封装后进行返回，整个文件下载的过程是没有过滤掉”./“、”…/“、”/“等特殊字符，防止用户进行目录回溯的，同时也没有限制下载目录。初步判断是存在任意文件下载风险的。<br>  这里尝试去测试环境访问对应的下载接口进行复现，发现失败了：<br><img src="https://www.sec-in.com/img/sin/M00/00/37/wKg0C18fmMuAEoN4AAB_-fUuTxw134.png" alt="图片.png"><br>  回去查看源代码，发现有一个安全过滤器SecurityFilter，里面针对相关的敏感字符进行了过滤处理。上述任意文件下载接口无法利用很大原因是过滤器Filter的防护导致的，下面来看看能不能绕过过滤器进行利用。</p>
<h1 id="绕过分析"><a href="#绕过分析" class="headerlink" title="绕过分析"></a>绕过分析</h1><p>  一般来说审计过滤器缺陷主要分以下几个点：</p>
<ul>
<li>获取数据的方式是否覆盖全面</li>
<li>过滤的规则内容</li>
<li>过滤器的顺序</li>
</ul>
<p>  首先是定位过滤器了，这里是通过注解的方式进行过滤器注册的：</p>
<pre><code class="java">@WebFilter(filterName = &quot;SecurityFilter&quot;, urlPatterns = &quot;/*&quot; )
public class SecurityFilter implements Filter &#123;

    FilterConfig filterConfig = null;

    @Override
    public void destroy() &#123;
        this.filterConfig = null;
    &#125;

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException &#123;
        chain.doFilter(new XssHttpServletRequestWrapper((HttpServletRequest) request), response);
    &#125;

    @Override
    public void init(FilterConfig filterConfig) throws ServletException &#123;
        this.filterConfig = filterConfig;
    &#125;
&#125;</code></pre>
<p>  具体实现是通过HttpServletRequestWrapper来获取request的内容，然后通过重写getParameterValues()、getParameter()方法进行处理的。</p>
<pre><code class="java">public class XssHttpServletRequestWrapper extends HttpServletRequestWrapper &#123;


    public XssHttpServletRequestWrapper(HttpServletRequest servletRequest) &#123;
        super(servletRequest);
    &#125;

    @Override
    public String[] getParameterValues(String parameter) &#123;
        String[] values = super.getParameterValues(parameter);
        if (values == null) &#123;
            return null;
        &#125;
        int count = values.length;
        String[] encodedValues = new String[count];
        for (int i = 0; i &lt; count; i++) &#123;
            System.out.println(&quot;before:&quot;+values[i]);
            encodedValues[i] = JsoupUtil.clean(cleanAnyFileRead((String) values[i]));
            System.out.println(&quot;after:&quot;+encodedValues[i]);
        &#125;
        return encodedValues;
    &#125;</code></pre>
<p>  这里存在第一种绕过方式，因为对于multipart/form-data这种数据类型上述过滤器明显也是无法获取request提交内容的，那么可以尝试转换multipart的方式进行提交，尝试绕过相关的过滤器：<br><img src="https://www.sec-in.com/img/sin/M00/00/37/wKg0C18fnFqAfHSbAAChd3ThyBA362.png" alt="图片.png"><br>  比较可惜的是，这里对任意文件下载接口并不适用，因为其是用@GetMapping(“/downloadFile.do”)进行注解的，限制了请求方法为GET。<br>  获取数据的方式虽然不全面，但是仅针对/downloadFile.do接口来说的话是足够的了，那么继续往下看相关的过滤规则是否存在缺陷。<br>  这里存在两层过滤，一层是通过cleanAnyFileRead()过滤任意文件上传的敏感输入的，第二层是调用工具类JsoupUtil.clean()方法进行XSS输入过滤。</p>
<pre><code class="java">@Override
public String getParameter(String parameter) &#123;
    String value = super.getParameter(parameter);
    if (value == null) &#123;
        return null;
    &#125;
    return JsoupUtil.clean(cleanAnyFileRead((String) value));
&#125;</code></pre>
<p>  首先看任意文件下载的过滤，这里是简单的使用正则进行过滤，出现一次或者多次的.且以/结尾的内容都进行过滤，例如…/、./等，这也就解释了为什么前面测试时输入…/…/…/etc/passwd失败了，过滤后返回的内容为/etc/passwd，拼接uploadPath后不存在相关的文件，路径穿越失败：</p>
<pre><code class="java">private static String cleanAnyFileRead(String value) &#123;
    value = value.replaceAll(&quot;\\.+/&quot;, &quot;&quot;);
    return value;
&#125;</code></pre>
<p>  继续往下看xss的过滤，JsoupUtil.clean()方法的具体实现如下：</p>
<pre><code class="java">public class JsoupUtil &#123;
    /**
     * 配置白名单为基本使用的标签再加上img标签
     */
    private static final Whitelist WHITELIST = Whitelist.basicWithImages();

    /**
     * 配置过滤的参数，不对代码格式化
     */
    private static final Document.OutputSettings OUTPUT_SETTINGS = new Document.OutputSettings().prettyPrint(false);

    static &#123;
        //富文本编辑时一些样式是使用style来进行实现的 比如红色字体 style=&quot;color:red;&quot; 所以需要给所有标签添加style属性
        WHITELIST.addAttributes(&quot;:all&quot;,&quot;style&quot;);
    &#125;

    public static String clean(String content)&#123;
        return Jsoup.clean(content,&quot;&quot;,WHITELIST,OUTPUT_SETTINGS);
    &#125;
&#125;</code></pre>
<p>  比较简单粗暴，直接使用jsoup组件进行了过滤。这里简单介绍下jsoup的api：<br>  使用Jsoup的clean方法进行清除HTML标签操作，该方法会清除在你所指定的白名单whitelist中的所有HTML标签。默认的Jsoup提供了5种Whitelist的API</p>
<ul>
<li>none()<br>该API会清除所有HTML标签，仅保留文本节点。</li>
<li>impleTest()<br>该API仅会保留b, em, i, strong, u 标签，除此之外的所有HTML标签都会被清除。</li>
<li>basic()<br>该API会保留 a, b, blockquote, br, cite, code, dd, dl, dt, em, i, li, ol, p, pre, q, small, span, strike, strong, sub, sup, u, ul 和其适当的属性标签，除此之外的所有HTML标签都会被清除，且该API不允许出现图片(img tag)。另外该API中允许出现的超链接中可以允许其指定http, https, ftp, mailto 且在超链接中强制追加rel=nofollow属性。</li>
<li>basicWithImages()<br>该API在保留basic()中允许出现的标签的同时也允许出现图片(img tag)和img的相关适当属性，且其src允许其指定 http 或 https。</li>
<li>relaxed()<br>该API仅会保留 a, b, blockquote, br, caption, cite, code, col, colgroup, dd, div, dl, dt, em, h1, h2, h3, h4, h5, h6, i, img, li, ol, p, pre, q, small, span, strike, strong, sub, sup, table, tbody, td, tfoot, th, thead, tr, u, ul 标签，除此之外的所有HTML标签都会被清除，且在超链接中不会强制追加rel=nofollow属性。</li>
<li>clean()<br>此外Jsoup的Whitelist提供了addTags方法，利用该方法可以对whitelist进行自定义扩展：</li>
</ul>
<pre><code>public Whitelist addTags(String... tags)</code></pre><p>  所以JsoupUtil.clean()方法的效果应该是输入<script>类的内容时,会自动转换为null。<br>  这么一看，相关的恶意数据被过滤了，好像也没啥问题。仔细琢磨下过滤的顺序问题，可以发现其实其中过滤方式是可以绕过进行任意文件下载的。<br>  要想对任意文件下载的接口进行利用，目的是让最后提交下载的地址为…/…/…/…/…/etc/passwd的方式，首先…/、./这种提交方式是直接被过滤掉了的，但是结合前面的正则表达式（出现一次或者多次的.且以/结尾的内容都进行过滤），…tkswifty/这种格式是可以通过过滤器安全检查的。<br>  此时再结合xss过滤，jsoup组件会把类似<script>内容替换为空。然后过滤的顺序是：</p>
<pre><code>任意文件下载-&gt;xss</code></pre><p>  那么也就是说，尝试使用…<details>/…<details>/…<details>/etc/passwd进行访问可以达到任意文件下载的效果：<br><img src="https://www.sec-in.com/img/sin/M00/00/37/wKg0C18fpaSAKCBbAABQJfgA-5M950.png" alt="图片.png"><br>  到环境上进行验证，成功绕过相关的过滤器安全限制读取了/etc/passwd内容：<br><img src="https://www.sec-in.com/img/sin/M00/00/37/wKg0C18fozWAdmbUAADT-6RGUwQ255.png" alt="图片.png"></p>
<h1 id="拓展与延伸"><a href="#拓展与延伸" class="headerlink" title="拓展与延伸"></a>拓展与延伸</h1><p>  上面的案例中一个过滤顺序的问题导致了相关的漏洞bypass，越复杂的设计可能存在的安全隐患就越多，针对文件下载业务，一般可以直接在对应的接口进行相关的检查，例如：</p>
<ul>
<li>对下载的文件类型进行白名单控制，限制下载的文件后缀；</li>
<li>使用类似Java的file.getCanonicalPath()判断文件的真实路径，仅允许下载规定路径下的文件。</li>
</ul>
<p>  此外，在日常的黑盒测试中，也可以结合常见的过滤器设计进行相关的FUZZ，尝试进行相关任意文件下载的绕过，例如可以结合SQL注入的过滤关键字：</p>
<pre><code>..|/..|/..|/..|/..|/..|/..|/..|/etc/passwd #Oracle的拼接符是||
.|./.|./.|./.|./.|./.|./.|./.|./etc/passwd #调整关键字的位置</code></pre><p>  又比如上述例子中的结合xss的关键字：</p>
<pre><code>..&lt;details&gt;/..&lt;details&gt;/..&lt;details&gt;/etc/passwd
.&lt;details&gt;./.&lt;details&gt;./.&lt;details&gt;./etc/passwd</code></pre><p>  又比如命令执行的关键字nc等。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined"></a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/09/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%BB%95%E8%BF%87%E8%BF%87%E7%A8%8B/">http://yoursite.com/2020/09/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%BB%95%E8%BF%87%E8%BF%87%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%82%A6%E8%AF%BB/">悦读</a><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/%E8%BD%AC%E8%BD%BD/">转载</a></div><div class="post_share"><div class="social-share" data-image="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/10/06/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%E4%B8%8A/"><img class="prev-cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">红日靶场练习（一）上</div></div></a></div><div class="next-post pull-right"><a href="/2020/09/04/session%E8%A6%86%E7%9B%96/"><img class="next-cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">session覆盖学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2020/09/04/Java反射的学习/" title="Java反射的学习"><img class="cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-04</div><div class="title">Java反射的学习</div></div></a></div><div><a href="/2020/09/04/Java反序列化的学习/" title="Java反序列化的学习"><img class="cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-04</div><div class="title">Java反序列化的学习</div></div></a></div><div><a href="/2021/06/13/Shiro反序列化漏洞学习/" title="Shiro反序列化漏洞学习"><img class="cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-13</div><div class="title">Shiro反序列化漏洞学习</div></div></a></div><div><a href="/2020/09/04/session覆盖/" title="session覆盖学习"><img class="cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-04</div><div class="title">session覆盖学习</div></div></a></div><div><a href="/2020/11/12/shellcode编写原则/" title="shellcode编写原则"><img class="cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-12</div><div class="title">shellcode编写原则</div></div></a></div><div><a href="/2021/07/24/ATT&CK红队评估实战靶场（一） 练习/" title="ATT&CK红队评估实战靶场（一） 练习"><img class="cover" src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-24</div><div class="title">ATT&CK红队评估实战靶场（一） 练习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://tva1.sinaimg.cn/large/008i3skNly1gsxjbgddgvj30u00u0gnx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name"></div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/York145"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/York145" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/2192557290@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">唯信仰与日月亘古不变</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8C%96%E6%8E%98%E8%BF%87%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">挖掘过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E8%BD%BD%EF%BC%9Ahttps-www-sec-in-com-article-486"><span class="toc-number">1.1.</span> <span class="toc-text">转载：https:&#x2F;&#x2F;www.sec-in.com&#x2F;article&#x2F;486</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">绕过分析</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/07/28/Weblogic%20T3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/" title="No title"><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="No title"/></a><div class="content"><a class="title" href="/2021/07/28/Weblogic%20T3%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/" title="No title">No title</a><time datetime="2021-07-28T08:03:56.288Z" title="Created 2021-07-28 16:03:56">2021-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/24/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA%EF%BC%88%E4%B8%80%EF%BC%89%20%E7%BB%83%E4%B9%A0/" title="ATT&amp;CK红队评估实战靶场（一） 练习"><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ATT&amp;CK红队评估实战靶场（一） 练习"/></a><div class="content"><a class="title" href="/2021/07/24/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA%EF%BC%88%E4%B8%80%EF%BC%89%20%E7%BB%83%E4%B9%A0/" title="ATT&amp;CK红队评估实战靶场（一） 练习">ATT&amp;CK红队评估实战靶场（一） 练习</a><time datetime="2021-07-24T11:31:01.000Z" title="Created 2021-07-24 19:31:01">2021-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/13/Shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/" title="Shiro反序列化漏洞学习"><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Shiro反序列化漏洞学习"/></a><div class="content"><a class="title" href="/2021/06/13/Shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/" title="Shiro反序列化漏洞学习">Shiro反序列化漏洞学习</a><time datetime="2021-06-13T11:16:01.000Z" title="Created 2021-06-13 19:16:01">2021-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/09/Java%20agent%E5%AD%A6%E4%B9%A0/" title="Java agent学习"><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java agent学习"/></a><div class="content"><a class="title" href="/2021/05/09/Java%20agent%E5%AD%A6%E4%B9%A0/" title="Java agent学习">Java agent学习</a><time datetime="2021-05-09T06:31:01.000Z" title="Created 2021-05-09 14:31:01">2021-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F--%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/" title="内网渗透--远程桌面"><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gobcme930kj31hc0u04cl.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网渗透--远程桌面"/></a><div class="content"><a class="title" href="/2021/04/29/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F--%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/" title="内网渗透--远程桌面">内网渗透--远程桌面</a><time datetime="2021-04-29T12:05:01.000Z" title="Created 2021-04-29 20:05:01">2021-04-29</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By null</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>